// ==UserScript==
// @name     tryrating-userscript
// @version  1.8.0
// @author   crashmax <userscript@crashmax.ru>
// @license  MIT
// @match    https://www.tryrating.com/app/survey/*
// @connect  github.io
// @grant    GM_setValue
// @grant    GM_getValue
// @grant    GM_addStyle
// @grant    GM_openInTab
// @grant    GM_notification
// @grant    GM_xmlhttpRequest
// @grant    GM_info
// ==/UserScript==

(function(){"use strict";const Tn={context:void 0,registry:void 0},Sn=(t,e)=>t===e,Z=Symbol("solid-proxy"),be=Symbol("solid-track"),At={equals:Sn};let ye=Se;const rt=1,Et=2,ve={owned:null,cleanups:null,context:null,owner:null};var O=null;let Kt=null,I=null,q=null,X=null,Ct=0;function we(t,e){const n=I,r=O,o=t.length===0,i=e===void 0?r:e,s=o?ve:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=o?t:()=>t(()=>j(()=>Lt(s)));O=s,I=null;try{return st(a,!0)}finally{I=n,O=r}}function G(t,e){e=e?Object.assign({},At,e):At;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),Te(n,o));return[$e.bind(n),r]}function J(t,e,n){const r=Xt(t,e,!1,rt);bt(r)}function Q(t,e,n){ye=_n;const r=Xt(t,e,!1,rt);(!n||!n.render)&&(r.user=!0),X?X.push(r):bt(r)}function K(t,e,n){n=n?Object.assign({},At,n):At;const r=Xt(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,bt(r),$e.bind(r)}function tt(t){return st(t,!1)}function j(t){if(I===null)return t();const e=I;I=null;try{return t()}finally{I=e}}function xe(t){Q(()=>j(t))}function mt(t){return O===null||(O.cleanups===null?O.cleanups=[t]:O.cleanups.push(t)),t}function Zt(){return I}function kn(){return O}function Dn(t,e){const n=O,r=I;O=t,I=null;try{return st(e,!0)}catch(o){Jt(o)}finally{O=n,I=r}}function Mn(t,e){const n=Symbol("context");return{id:n,Provider:Ln(n),defaultValue:t}}function On(t){return O&&O.context&&O.context[t.id]!==void 0?O.context[t.id]:t.defaultValue}function An(t){const e=K(t),n=K(()=>Qt(e()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function $e(){if(this.sources&&this.state)if(this.state===rt)bt(this);else{const t=q;q=null,st(()=>It(this),!1),q=t}if(I){const t=this.observers?this.observers.length:0;I.sources?(I.sources.push(this),I.sourceSlots.push(t)):(I.sources=[this],I.sourceSlots=[t]),this.observers?(this.observers.push(I),this.observerSlots.push(I.sources.length-1)):(this.observers=[I],this.observerSlots=[I.sources.length-1])}return this.value}function Te(t,e,n){let r=t.value;return(!t.comparator||!t.comparator(r,e))&&(t.value=e,t.observers&&t.observers.length&&st(()=>{for(let o=0;o<t.observers.length;o+=1){const i=t.observers[o],s=Kt&&Kt.running;s&&Kt.disposed.has(i),(s?!i.tState:!i.state)&&(i.pure?q.push(i):X.push(i),i.observers&&ke(i)),s||(i.state=rt)}if(q.length>1e6)throw q=[],new Error},!1)),e}function bt(t){if(!t.fn)return;Lt(t);const e=Ct;En(t,t.value,e)}function En(t,e,n){let r;const o=O,i=I;I=O=t;try{r=t.fn(e)}catch(s){return t.pure&&(t.state=rt,t.owned&&t.owned.forEach(Lt),t.owned=null),t.updatedAt=n+1,Jt(s)}finally{I=i,O=o}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?Te(t,r):t.value=r,t.updatedAt=n)}function Xt(t,e,n,r=rt,o){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:O,context:O?O.context:null,pure:n};return O===null||O!==ve&&(O.owned?O.owned.push(i):O.owned=[i]),i}function _t(t){if(t.state===0)return;if(t.state===Et)return It(t);if(t.suspense&&j(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Ct);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===rt)bt(t);else if(t.state===Et){const r=q;q=null,st(()=>It(t,e[0]),!1),q=r}}function st(t,e){if(q)return t();let n=!1;e||(q=[]),X?n=!0:X=[],Ct++;try{const r=t();return Cn(n),r}catch(r){n||(X=null),q=null,Jt(r)}}function Cn(t){if(q&&(Se(q),q=null),t)return;const e=X;X=null,e.length&&st(()=>ye(e),!1)}function Se(t){for(let e=0;e<t.length;e++)_t(t[e])}function _n(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[n++]=r:_t(r)}for(e=0;e<n;e++)_t(t[e])}function It(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];if(r.sources){const o=r.state;o===rt?r!==e&&(!r.updatedAt||r.updatedAt<Ct)&&_t(r):o===Et&&It(r,e)}}}function ke(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=Et,n.pure?q.push(n):X.push(n),n.observers&&ke(n))}}function Lt(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),r=t.sourceSlots.pop(),o=n.observers;if(o&&o.length){const i=o.pop(),s=n.observerSlots.pop();r<o.length&&(i.sourceSlots[s]=r,o[r]=i,n.observerSlots[r]=s)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Lt(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function In(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Jt(t,e=O){throw In(t)}function Qt(t){if(typeof t=="function"&&!t.length)return Qt(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const r=Qt(t[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return t}function Ln(t,e){return function(r){let o;return J(()=>o=j(()=>(O.context={...O.context,[t]:r.value},An(()=>r.children))),void 0),o}}function Y(t,e){return j(()=>t(e||{}))}function Pt(){return!0}const Pn={get(t,e,n){return e===Z?n:t.get(e)},has(t,e){return e===Z?!0:t.has(e)},set:Pt,deleteProperty:Pt,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Pt,deleteProperty:Pt}},ownKeys(t){return t.keys()}};function te(t){return(t=typeof t=="function"?t():t)?t:{}}function Nn(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function Nt(...t){let e=!1;for(let i=0;i<t.length;i++){const s=t[i];e=e||!!s&&Z in s,t[i]=typeof s=="function"?(e=!0,K(s)):s}if(e)return new Proxy({get(i){for(let s=t.length-1;s>=0;s--){const a=te(t[s])[i];if(a!==void 0)return a}},has(i){for(let s=t.length-1;s>=0;s--)if(i in te(t[s]))return!0;return!1},keys(){const i=[];for(let s=0;s<t.length;s++)i.push(...Object.keys(te(t[s])));return[...new Set(i)]}},Pn);const n={},r={},o=new Set;for(let i=t.length-1;i>=0;i--){const s=t[i];if(!s)continue;const a=Object.getOwnPropertyNames(s);for(let c=0,p=a.length;c<p;c++){const d=a[c];if(d==="__proto__"||d==="constructor")continue;const h=Object.getOwnPropertyDescriptor(s,d);if(!o.has(d))h.get?(o.add(d),Object.defineProperty(n,d,{enumerable:!0,configurable:!0,get:Nn.bind(r[d]=[h.get.bind(s)])})):(h.value!==void 0&&o.add(d),n[d]=h.value);else{const w=r[d];w?h.get?w.push(h.get.bind(s)):h.value!==void 0&&w.push(()=>h.value):n[d]===void 0&&(n[d]=h.value)}}}return n}const jn=t=>`Stale read from <${t}>.`;function De(t){const e=t.keyed,n=K(()=>t.when,void 0,{equals:(r,o)=>e?r===o:!r==!o});return K(()=>{const r=n();if(r){const o=t.children;return typeof o=="function"&&o.length>0?j(()=>o(e?r:()=>{if(!j(n))throw jn("Show");return t.when})):o}return t.fallback},void 0,void 0)}const Un=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Fn=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...Un]),Rn=new Set(["innerHTML","textContent","innerText","children"]),zn=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Yn=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Bn(t,e){const n=Yn[t];return typeof n=="object"?n[e]?n.$:void 0:n}const qn=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Hn={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function Wn(t,e,n){let r=n.length,o=e.length,i=r,s=0,a=0,c=e[o-1].nextSibling,p=null;for(;s<o||a<i;){if(e[s]===n[a]){s++,a++;continue}for(;e[o-1]===n[i-1];)o--,i--;if(o===s){const d=i<r?a?n[a-1].nextSibling:n[i-a]:c;for(;a<i;)t.insertBefore(n[a++],d)}else if(i===a)for(;s<o;)(!p||!p.has(e[s]))&&e[s].remove(),s++;else if(e[s]===n[i-1]&&n[a]===e[o-1]){const d=e[--o].nextSibling;t.insertBefore(n[a++],e[s++].nextSibling),t.insertBefore(n[--i],d),e[o]=n[i]}else{if(!p){p=new Map;let h=a;for(;h<i;)p.set(n[h],h++)}const d=p.get(e[s]);if(d!=null)if(a<d&&d<i){let h=s,w=1,x;for(;++h<o&&h<i&&!((x=p.get(e[h]))==null||x!==d+w);)w++;if(w>d-a){const T=e[s];for(;a<d;)t.insertBefore(n[a++],T)}else t.replaceChild(n[a++],e[s++])}else s++;else e[s++].remove()}}}const Me="_$DX_DELEGATE";function Vn(t,e,n,r={}){let o;return we(i=>{o=i,e===document?t():ot(e,t(),e.firstChild?null:void 0,n)},r.owner),()=>{o(),e.textContent=""}}function et(t,e,n){let r;const o=()=>{const s=document.createElement("template");return s.innerHTML=t,n?s.content.firstChild.firstChild:s.content.firstChild},i=e?()=>j(()=>document.importNode(r||(r=o()),!0)):()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function Oe(t,e=window.document){const n=e[Me]||(e[Me]=new Set);for(let r=0,o=t.length;r<o;r++){const i=t[r];n.has(i)||(n.add(i),e.addEventListener(i,Qn))}}function ee(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function Gn(t,e,n,r){r==null?t.removeAttributeNS(e,n):t.setAttributeNS(e,n,r)}function Ae(t,e){e==null?t.removeAttribute("class"):t.className=e}function Kn(t,e,n,r){if(r)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const o=n[0];t.addEventListener(e,n[0]=i=>o.call(t,n[1],i))}else t.addEventListener(e,n)}function Zn(t,e,n={}){const r=Object.keys(e||{}),o=Object.keys(n);let i,s;for(i=0,s=o.length;i<s;i++){const a=o[i];!a||a==="undefined"||e[a]||(_e(t,a,!1),delete n[a])}for(i=0,s=r.length;i<s;i++){const a=r[i],c=!!e[a];!a||a==="undefined"||n[a]===c||!c||(_e(t,a,!0),n[a]=c)}return n}function Ee(t,e,n){if(!e)return n?ee(t,"style"):e;const r=t.style;if(typeof e=="string")return r.cssText=e;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),e||(e={});let o,i;for(i in n)e[i]==null&&r.removeProperty(i),delete n[i];for(i in e)o=e[i],o!==n[i]&&(r.setProperty(i,o),n[i]=o);return n}function ne(t,e={},n,r){const o={};return r||J(()=>o.children=ct(t,e.children,o.children)),J(()=>e.ref&&e.ref(t)),J(()=>Xn(t,e,n,!0,o,!0)),o}function Ce(t,e,n){return j(()=>t(e,n))}function ot(t,e,n,r){if(n!==void 0&&!r&&(r=[]),typeof e!="function")return ct(t,e,r,n);J(o=>ct(t,e(),o,n),r)}function Xn(t,e,n,r,o={},i=!1){e||(e={});for(const s in o)if(!(s in e)){if(s==="children")continue;o[s]=Ie(t,s,null,o[s],n,i)}for(const s in e){if(s==="children"){r||ct(t,e.children);continue}const a=e[s];o[s]=Ie(t,s,a,o[s],n,i)}}function Jn(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function _e(t,e,n){const r=e.trim().split(/\s+/);for(let o=0,i=r.length;o<i;o++)t.classList.toggle(r[o],n)}function Ie(t,e,n,r,o,i){let s,a,c,p,d;if(e==="style")return Ee(t,n,r);if(e==="classList")return Zn(t,n,r);if(n===r)return r;if(e==="ref")i||n(t);else if(e.slice(0,3)==="on:"){const h=e.slice(3);r&&t.removeEventListener(h,r),n&&t.addEventListener(h,n)}else if(e.slice(0,10)==="oncapture:"){const h=e.slice(10);r&&t.removeEventListener(h,r,!0),n&&t.addEventListener(h,n,!0)}else if(e.slice(0,2)==="on"){const h=e.slice(2).toLowerCase(),w=qn.has(h);if(!w&&r){const x=Array.isArray(r)?r[0]:r;t.removeEventListener(h,x)}(w||n)&&(Kn(t,h,n,w),w&&Oe([h]))}else if(e.slice(0,5)==="attr:")ee(t,e.slice(5),n);else if((d=e.slice(0,5)==="prop:")||(c=Rn.has(e))||!o&&((p=Bn(e,t.tagName))||(a=Fn.has(e)))||(s=t.nodeName.includes("-")))d&&(e=e.slice(5),a=!0),e==="class"||e==="className"?Ae(t,n):s&&!a&&!c?t[Jn(e)]=n:t[p||e]=n;else{const h=o&&e.indexOf(":")>-1&&Hn[e.split(":")[0]];h?Gn(t,h,e,n):ee(t,zn[e]||e,n)}return n}function Qn(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const r=n[e];if(r&&!n.disabled){const o=n[`${e}Data`];if(o!==void 0?r.call(n,o,t):r.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function ct(t,e,n,r,o){for(;typeof n=="function";)n=n();if(e===n)return n;const i=typeof e,s=r!==void 0;if(t=s&&n[0]&&n[0].parentNode||t,i==="string"||i==="number")if(i==="number"&&(e=e.toString()),s){let a=n[0];a&&a.nodeType===3?a.data=e:a=document.createTextNode(e),n=ut(t,n,r,a)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e;else if(e==null||i==="boolean")n=ut(t,n,r);else{if(i==="function")return J(()=>{let a=e();for(;typeof a=="function";)a=a();n=ct(t,a,n,r)}),()=>n;if(Array.isArray(e)){const a=[],c=n&&Array.isArray(n);if(re(a,e,n,o))return J(()=>n=ct(t,a,n,r,!0)),()=>n;if(a.length===0){if(n=ut(t,n,r),s)return n}else c?n.length===0?Le(t,a,r):Wn(t,n,a):(n&&ut(t),Le(t,a));n=a}else if(e.nodeType){if(Array.isArray(n)){if(s)return n=ut(t,n,r,e);ut(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function re(t,e,n,r){let o=!1;for(let i=0,s=e.length;i<s;i++){let a=e[i],c=n&&n[i],p;if(!(a==null||a===!0||a===!1))if((p=typeof a)=="object"&&a.nodeType)t.push(a);else if(Array.isArray(a))o=re(t,a,c)||o;else if(p==="function")if(r){for(;typeof a=="function";)a=a();o=re(t,Array.isArray(a)?a:[a],Array.isArray(c)?c:[c])||o}else t.push(a),o=!0;else{const d=String(a);c&&c.nodeType===3&&c.data===d?t.push(c):t.push(document.createTextNode(d))}}return o}function Le(t,e,n=null){for(let r=0,o=e.length;r<o;r++)t.insertBefore(e[r],n)}function ut(t,e,n,r){if(n===void 0)return t.textContent="";const o=r||document.createTextNode("");if(e.length){let i=!1;for(let s=e.length-1;s>=0;s--){const a=e[s];if(o!==a){const c=a.parentNode===t;!i&&!s?c?t.replaceChild(o,a):t.insertBefore(o,n):c&&a.remove()}else i=!0}}else t.insertBefore(o,n);return[o]}const tr="http://www.w3.org/2000/svg";function er(t,e=!1){return e?document.createElementNS(tr,t):document.createElement(t)}function nr(t){const{useShadow:e}=t,n=document.createTextNode(""),r=()=>t.mount||document.body,o=kn();let i,s=!!Tn.context;return Q(()=>{i||(i=Dn(o,()=>K(()=>t.children)));const a=r();if(a instanceof HTMLHeadElement){const[c,p]=G(!1),d=()=>p(!0);we(h=>ot(a,()=>c()?h():i(),null)),mt(d)}else{const c=er(t.isSVG?"g":"div",t.isSVG),p=e&&c.attachShadow?c.attachShadow({mode:"open"}):c;Object.defineProperty(c,"_$host",{get(){return n.parentNode},configurable:!0}),ot(p,i),a.appendChild(c),t.ref&&t.ref(c),mt(()=>a.removeChild(c))}},void 0,{render:!s}),n}const oe="https://crashmax-dev.github.io/tryrating-userscript",rr=`${oe}/tryrating-userscript.meta.js`,or=`${oe}/tryrating-userscript.user.js`,ir=`${oe}/notify.ogg`,yt={openTasks:t=>t.altKey&&t.key==="1",resetTasks:t=>t.altKey&&t.key==="2",resetWidgetPosition:t=>t.altKey&&t.key==="3",toggleAutoSubmit:t=>t.ctrlKey&&t.code==="KeyO",toggleWidgetVisibility:t=>t.ctrlKey&&t.code==="KeyX"},sr=`
Alt + 1 - \u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0441\u043F\u0438\u0441\u043E\u043A \u0437\u0430\u0434\u0430\u0447
Alt + 2 - \u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007
Alt + 3 - \u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u043F\u043E\u0437\u0438\u0446\u0438\u044E \u0432\u0438\u0434\u0436\u0435\u0442\u0430\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007
Ctrl + O - \u0412\u043A\u043B\u044E\u0447\u0438\u0442\u044C/\u0432\u044B\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007\u2007
Ctrl + X - \u0421\u043A\u0440\u044B\u0442\u044C/\u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0438\u0434\u0436\u0435\u0442
`;var ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pe={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ie,function(){var n=1e3,r=6e4,o=36e5,i="millisecond",s="second",a="minute",c="hour",p="day",d="week",h="month",w="quarter",x="year",T="date",b="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,P=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var u=["th","st","nd","rd"],f=l%100;return"["+l+(u[(f-20)%10]||u[f]||u[0])+"]"}},C=function(l,u,f){var y=String(l);return!y||y.length>=u?l:""+Array(u+1-y.length).join(f)+l},N={s:C,z:function(l){var u=-l.utcOffset(),f=Math.abs(u),y=Math.floor(f/60),g=f%60;return(u<=0?"+":"-")+C(y,2,"0")+":"+C(g,2,"0")},m:function l(u,f){if(u.date()<f.date())return-l(f,u);var y=12*(f.year()-u.year())+(f.month()-u.month()),g=u.clone().add(y,h),m=f-g<0,v=u.clone().add(y+(m?-1:1),h);return+(-(y+(f-g)/(m?g-v:v-g))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:h,y:x,w:d,d:p,D:T,h:c,m:a,s,ms:i,Q:w}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},D="en",L={};L[D]=E;var z="$isDayjsObject",W=function(l){return l instanceof Dt||!(!l||!l[z])},B=function l(u,f,y){var g;if(!u)return D;if(typeof u=="string"){var m=u.toLowerCase();L[m]&&(g=m),f&&(L[m]=f,g=m);var v=u.split("-");if(!g&&v.length>1)return l(v[0])}else{var $=u.name;L[$]=u,g=$}return!y&&g&&(D=g),g||!y&&D},A=function(l,u){if(W(l))return l.clone();var f=typeof u=="object"?u:{};return f.date=l,f.args=arguments,new Dt(f)},k=N;k.l=B,k.i=W,k.w=function(l,u){return A(l,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var Dt=function(){function l(f){this.$L=B(f.locale,null,!0),this.parse(f),this.$x=this.$x||f.x||{},this[z]=!0}var u=l.prototype;return u.parse=function(f){this.$d=function(y){var g=y.date,m=y.utc;if(g===null)return new Date(NaN);if(k.u(g))return new Date;if(g instanceof Date)return new Date(g);if(typeof g=="string"&&!/Z$/i.test(g)){var v=g.match(S);if(v){var $=v[2]-1||0,M=(v[7]||"0").substring(0,3);return m?new Date(Date.UTC(v[1],$,v[3]||1,v[4]||0,v[5]||0,v[6]||0,M)):new Date(v[1],$,v[3]||1,v[4]||0,v[5]||0,v[6]||0,M)}}return new Date(g)}(f),this.init()},u.init=function(){var f=this.$d;this.$y=f.getFullYear(),this.$M=f.getMonth(),this.$D=f.getDate(),this.$W=f.getDay(),this.$H=f.getHours(),this.$m=f.getMinutes(),this.$s=f.getSeconds(),this.$ms=f.getMilliseconds()},u.$utils=function(){return k},u.isValid=function(){return this.$d.toString()!==b},u.isSame=function(f,y){var g=A(f);return this.startOf(y)<=g&&g<=this.endOf(y)},u.isAfter=function(f,y){return A(f)<this.startOf(y)},u.isBefore=function(f,y){return this.endOf(y)<A(f)},u.$g=function(f,y,g){return k.u(f)?this[y]:this.set(g,f)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(f,y){var g=this,m=!!k.u(y)||y,v=k.p(f),$=function(lt,V){var it=k.w(g.$u?Date.UTC(g.$y,V,lt):new Date(g.$y,V,lt),g);return m?it:it.endOf(p)},M=function(lt,V){return k.w(g.toDate()[lt].apply(g.toDate("s"),(m?[0,0,0,0]:[23,59,59,999]).slice(V)),g)},_=this.$W,F=this.$M,H=this.$D,pt="set"+(this.$u?"UTC":"");switch(v){case x:return m?$(1,0):$(31,11);case h:return m?$(1,F):$(0,F+1);case d:var at=this.$locale().weekStart||0,Mt=(_<at?_+7:_)-at;return $(m?H-Mt:H+(6-Mt),F);case p:case T:return M(pt+"Hours",0);case c:return M(pt+"Minutes",1);case a:return M(pt+"Seconds",2);case s:return M(pt+"Milliseconds",3);default:return this.clone()}},u.endOf=function(f){return this.startOf(f,!1)},u.$set=function(f,y){var g,m=k.p(f),v="set"+(this.$u?"UTC":""),$=(g={},g[p]=v+"Date",g[T]=v+"Date",g[h]=v+"Month",g[x]=v+"FullYear",g[c]=v+"Hours",g[a]=v+"Minutes",g[s]=v+"Seconds",g[i]=v+"Milliseconds",g)[m],M=m===p?this.$D+(y-this.$W):y;if(m===h||m===x){var _=this.clone().set(T,1);_.$d[$](M),_.init(),this.$d=_.set(T,Math.min(this.$D,_.daysInMonth())).$d}else $&&this.$d[$](M);return this.init(),this},u.set=function(f,y){return this.clone().$set(f,y)},u.get=function(f){return this[k.p(f)]()},u.add=function(f,y){var g,m=this;f=Number(f);var v=k.p(y),$=function(F){var H=A(m);return k.w(H.date(H.date()+Math.round(F*f)),m)};if(v===h)return this.set(h,this.$M+f);if(v===x)return this.set(x,this.$y+f);if(v===p)return $(1);if(v===d)return $(7);var M=(g={},g[a]=r,g[c]=o,g[s]=n,g)[v]||1,_=this.$d.getTime()+f*M;return k.w(_,this)},u.subtract=function(f,y){return this.add(-1*f,y)},u.format=function(f){var y=this,g=this.$locale();if(!this.isValid())return g.invalidDate||b;var m=f||"YYYY-MM-DDTHH:mm:ssZ",v=k.z(this),$=this.$H,M=this.$m,_=this.$M,F=g.weekdays,H=g.months,pt=g.meridiem,at=function(V,it,Ot,Gt){return V&&(V[it]||V(y,m))||Ot[it].slice(0,Gt)},Mt=function(V){return k.s($%12||12,V,"0")},lt=pt||function(V,it,Ot){var Gt=V<12?"AM":"PM";return Ot?Gt.toLowerCase():Gt};return m.replace(P,function(V,it){return it||function(Ot){switch(Ot){case"YY":return String(y.$y).slice(-2);case"YYYY":return k.s(y.$y,4,"0");case"M":return _+1;case"MM":return k.s(_+1,2,"0");case"MMM":return at(g.monthsShort,_,H,3);case"MMMM":return at(H,_);case"D":return y.$D;case"DD":return k.s(y.$D,2,"0");case"d":return String(y.$W);case"dd":return at(g.weekdaysMin,y.$W,F,2);case"ddd":return at(g.weekdaysShort,y.$W,F,3);case"dddd":return F[y.$W];case"H":return String($);case"HH":return k.s($,2,"0");case"h":return Mt(1);case"hh":return Mt(2);case"a":return lt($,M,!0);case"A":return lt($,M,!1);case"m":return String(M);case"mm":return k.s(M,2,"0");case"s":return String(y.$s);case"ss":return k.s(y.$s,2,"0");case"SSS":return k.s(y.$ms,3,"0");case"Z":return v}return null}(V)||v.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(f,y,g){var m,v=this,$=k.p(y),M=A(f),_=(M.utcOffset()-this.utcOffset())*r,F=this-M,H=function(){return k.m(v,M)};switch($){case x:m=H()/12;break;case h:m=H();break;case w:m=H()/3;break;case d:m=(F-_)/6048e5;break;case p:m=(F-_)/864e5;break;case c:m=F/o;break;case a:m=F/r;break;case s:m=F/n;break;default:m=F}return g?m:k.a(m)},u.daysInMonth=function(){return this.endOf(h).$D},u.$locale=function(){return L[this.$L]},u.locale=function(f,y){if(!f)return this.$L;var g=this.clone(),m=B(f,y,!0);return m&&(g.$L=m),g},u.clone=function(){return k.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},l}(),Vt=Dt.prototype;return A.prototype=Vt,[["$ms",i],["$s",s],["$m",a],["$H",c],["$W",p],["$M",h],["$y",x],["$D",T]].forEach(function(l){Vt[l[1]]=function(u){return this.$g(u,l[0],l[1])}}),A.extend=function(l,u){return l.$i||(l(u,Dt,A),l.$i=!0),A},A.locale=B,A.isDayjs=W,A.unix=function(l){return A(1e3*l)},A.en=L[D],A.Ls=L,A.p={},A})})(Pe);var ar=Pe.exports;const se=jt(ar);var Ne={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ie,function(){var n={year:0,month:1,day:2,hour:3,minute:4,second:5},r={};return function(o,i,s){var a,c=function(w,x,T){T===void 0&&(T={});var b=new Date(w),S=function(P,E){E===void 0&&(E={});var C=E.timeZoneName||"short",N=P+"|"+C,D=r[N];return D||(D=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:P,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:C}),r[N]=D),D}(x,T);return S.formatToParts(b)},p=function(w,x){for(var T=c(w,x),b=[],S=0;S<T.length;S+=1){var P=T[S],E=P.type,C=P.value,N=n[E];N>=0&&(b[N]=parseInt(C,10))}var D=b[3],L=D===24?0:D,z=b[0]+"-"+b[1]+"-"+b[2]+" "+L+":"+b[4]+":"+b[5]+":000",W=+w;return(s.utc(z).valueOf()-(W-=W%1e3))/6e4},d=i.prototype;d.tz=function(w,x){w===void 0&&(w=a);var T=this.utcOffset(),b=this.toDate(),S=b.toLocaleString("en-US",{timeZone:w}),P=Math.round((b-new Date(S))/1e3/60),E=s(S,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(b.getTimezoneOffset()/15)-P,!0);if(x){var C=E.utcOffset();E=E.add(T-C,"minute")}return E.$x.$timezone=w,E},d.offsetName=function(w){var x=this.$x.$timezone||s.tz.guess(),T=c(this.valueOf(),x,{timeZoneName:w}).find(function(b){return b.type.toLowerCase()==="timezonename"});return T&&T.value};var h=d.startOf;d.startOf=function(w,x){if(!this.$x||!this.$x.$timezone)return h.call(this,w,x);var T=s(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return h.call(T,w,x).tz(this.$x.$timezone,!0)},s.tz=function(w,x,T){var b=T&&x,S=T||x||a,P=p(+s(),S);if(typeof w!="string")return s(w).tz(S);var E=function(L,z,W){var B=L-60*z*1e3,A=p(B,W);if(z===A)return[B,z];var k=p(B-=60*(A-z)*1e3,W);return A===k?[B,A]:[L-60*Math.min(A,k)*1e3,Math.max(A,k)]}(s.utc(w,b).valueOf(),P,S),C=E[0],N=E[1],D=s(C).utcOffset(N);return D.$x.$timezone=S,D},s.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},s.tz.setDefault=function(w){a=w}}})})(Ne);var lr=Ne.exports;const cr=jt(lr);var je={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ie,function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,o=/([+-]|\d\d)/g;return function(i,s,a){var c=s.prototype;a.utc=function(b){var S={date:b,utc:!0,args:arguments};return new s(S)},c.utc=function(b){var S=a(this.toDate(),{locale:this.$L,utc:!0});return b?S.add(this.utcOffset(),n):S},c.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var p=c.parse;c.parse=function(b){b.utc&&(this.$u=!0),this.$utils().u(b.$offset)||(this.$offset=b.$offset),p.call(this,b)};var d=c.init;c.init=function(){if(this.$u){var b=this.$d;this.$y=b.getUTCFullYear(),this.$M=b.getUTCMonth(),this.$D=b.getUTCDate(),this.$W=b.getUTCDay(),this.$H=b.getUTCHours(),this.$m=b.getUTCMinutes(),this.$s=b.getUTCSeconds(),this.$ms=b.getUTCMilliseconds()}else d.call(this)};var h=c.utcOffset;c.utcOffset=function(b,S){var P=this.$utils().u;if(P(b))return this.$u?0:P(this.$offset)?h.call(this):this.$offset;if(typeof b=="string"&&(b=function(D){D===void 0&&(D="");var L=D.match(r);if(!L)return null;var z=(""+L[0]).match(o)||["-",0,0],W=z[0],B=60*+z[1]+ +z[2];return B===0?0:W==="+"?B:-B}(b),b===null))return this;var E=Math.abs(b)<=16?60*b:b,C=this;if(S)return C.$offset=E,C.$u=b===0,C;if(b!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(C=this.local().add(E+N,n)).$offset=E,C.$x.$localOffset=N}else C=this.utc();return C};var w=c.format;c.format=function(b){var S=b||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return w.call(this,S)},c.valueOf=function(){var b=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*b},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var x=c.toDate;c.toDate=function(b){return b==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var T=c.diff;c.diff=function(b,S,P){if(b&&this.$u===b.$u)return T.call(this,b,S,P);var E=this.local(),C=a(b).local();return T.call(E,C,S,P)}}})})(je);var ur=je.exports;const fr=jt(ur);se.extend(fr),se.extend(cr);const Ue={offset:180,region:"Asia",location:"Kuwait"};function Ut(){return se.tz(new Date,`${Ue.region}/${Ue.location}`).format("DD.MM.YYYY")}async function Fe(t=1e3){return new Promise(e=>setTimeout(e,t))}function dr(t){return Object.entries(t)}function Ft(t){return t=Math.abs(t),t>9?`${t}`:`0${t}`}function Re(t=0,e=Number.MAX_SAFE_INTEGER-1){return Math.floor(Math.random()*(e-t+1))+t}var gr=function(e){try{var n=/\B(\/\/ ==UserScript==\r?\n([\S\s]*?)\r?\n\/\/ ==\/UserScript==)([\S\s]*)/,r=e.match(n);if(!r)return null;var o=r[1],i=r[2],s=r[3],a={},c=i.split(`
`);return c.forEach(function(p){var d=p.match(/@([\w-]+)\s+(.+)/);d&&(a[d[1]]=a[d[1]]||[],a[d[1]].push(d[2]))}),{meta:a,metablock:o,content:s}}catch(p){return console&&console.error(p),null}};const hr=jt(gr),[pr,mr]=G(!1);class br{get currentVersion(){return GM_info.script.version}checkUpdates(){pr()||(U.info("Check updates..."),GM_xmlhttpRequest({url:rr,onload:({response:e})=>{const n=hr(e);if(!n){U.error("Failed to parse metadata");return}this.checkMetadata(n.meta)},onerror:e=>{U.error(e)}}))}checkMetadata(e){if(e.version[0]===this.currentVersion)return;if(U.info("Founded new version",e.version),!confirm(`\u041D\u0430\u0439\u0434\u0435\u043D\u0430 \u043D\u043E\u0432\u0430\u044F \u0432\u0435\u0440\u0441\u0438\u044F ${e.version}.
\u0416\u0435\u043B\u0430\u0435\u0442\u0435 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C?`)){mr(!0);return}GM_openInTab(or,{active:!0}).onclose=()=>{location.reload()}}}const ze=new br,Ye={info:"#2ecc71",debug:"#7f8c8d",warn:"#f39c12",error:"#c0392b"};function yr(t){return[`background: ${Ye[t]}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em","font-family: cursive"].join(";")}function vr(t){return dr(Ye).reduce((e,[n])=>(e[n]=(...r)=>{console[n](`%c${t}`,yr(n),...r)},e),{})}const U=vr(`tryrating-userscript ${ze.currentVersion}`),ae=()=>[{date:Ut(),total:0,estimated:0,list:[]}],[vt,le]=G([]);class wr{STORAGE_KEY="tryrating-storage-v3";constructor(){this.read()}get taskList(){return vt()}read(){const e=GM_getValue(this.STORAGE_KEY,ae());U.info("Loaded tasks",e),le(e)}reset(){le(ae()),GM_setValue(this.STORAGE_KEY,vt())}write(e){const n=this.getTaskList();n.total+=1,n.estimated+=e.estimated;const r=n.list.find(i=>i.type===e.type);r?(r.count+=1,r.estimated+=e.estimated):n.list.push({count:1,type:e.type,estimated:e.estimated});const o=[n,...vt().filter(i=>i.date!==n.date)];le(o),GM_setValue(this.STORAGE_KEY,vt())}getTaskList(){const e=Ut();U.info("Current date",e);const n=vt().find(r=>r.date===e);return U.info("Task list",n),n||ae()[0]}}const Rt=new wr;function R(t,e,...n){const r=document.createElement(t);return e instanceof Node?r.append(e):typeof e=="string"?r.append(xr(e)):Array.isArray(e)?r.append(...e):(Object.assign(r,e),Object.assign(r.style,e?.style)),r.append(...n),r}function xr(t){return document.createTextNode(t)}function Be(t,e,n){const r=new MutationObserver((o,i)=>{for(const s of o)e(s,i)});return r.observe(t,{childList:!0,subtree:!0,...n}),()=>r.disconnect()}function qe({selector:t,target:e=document.body,rejectTimeoutMs:n,signal:r}){return new Promise((o,i)=>{const s=Be(e,(p,d)=>{const h=e.querySelector(t);h&&(d.disconnect(),o(h))}),a={timeout:null,abort:null},c=p=>{a.timeout&&clearTimeout(a.timeout),a.abort&&r.removeEventListener("abort",a.abort),s(),i(p)};n>0&&(a.timeout=setTimeout(()=>c(`${qe.name} rejected (${n}ms)`),n)),r&&!r.aborted&&(a.abort=()=>c(r.reason),r.addEventListener("abort",a.abort))})}function He(t){return Ft(Number((t%6e4/1e3).toFixed(0)))}function We(t){const e=Ft(Math.floor(t/6e4)),n=He(t);return`${e}:${n}`}function Ve(t){const e=Ft(Math.floor(t/36e5)),n=Ft(Math.floor(t%36e5/6e4)),r=He(t);return`${e}:${n}:${r}`}const $r=`function savePage() {
  const body = document.body.cloneNode(true)
  body.querySelector('button')?.remove()
  body.querySelector('script')?.remove()

  const blob = new Blob([body.outerHTML], {
    type: 'text/html'
  })

  const link = document.createElement('a')
  Object.assign(link, {
    target: '_blank',
    href: URL.createObjectURL(blob),
    download: 'tryrating-__DATE__.html'
  })

  link.click()
}
`,Tr=`* {
  margin: 0;
  box-sizing: border-box;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

table {
  width: 100%;
  border-collapse: collapse;
  border: 1px solid #ddd;
}

caption {
  background: linear-gradient(to bottom, #f2f2f2, #e6e6e6);
  color: #333;
  font-weight: bold;
  font-size: 18px;
  padding: 10px;
  text-align: center;
}

p {
  text-align: start;
}

th {
  background-color: #f2f2f2;
  font-weight: bold;
  padding: 8px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

td {
  padding: 8px;
  border-bottom: 1px solid #ddd;
}

tr:nth-child(even) {
  background-color: #f9f9f9;
}

tr:hover {
  background-color: #e6e6e6;
}

td:hover {
  background-color: #e6e6e6;
}

th:first-child,
td:first-child {
  width: 80%;
}

th:nth-child(2),
td:nth-child(2) {
  width: 10%;
}

th:nth-child(3),
td:nth-child(3) {
  width: 10%;
}

button {
  font-family: inherit;
  font-weight: 600;
  position: fixed;
  right: 1rem;
  top: 1rem;
  display: inline-block;
  border: none;
  padding: 10px 20px;
  background-color: #f5f5f5;
  color: #333;
  font-size: 1rem;
  text-align: center;
  text-decoration: none;
  cursor: pointer;
  border-collapse: collapse;
  border-spacing: 0;
  border: 1px solid #ddd;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.4);
}

button:hover {
  background-color: #e0e0e0;
}

button:focus {
  outline: none;
  box-shadow: 0 0 0 2px #999;
}
`;class ft{static page(){const e=R("style",Tr),n=R("script",$r.replace("__DATE__",Ut())),r=R("button",{className:"save-button"},"Save");return r.setAttribute("onclick","savePage()"),R("div",r,e,n)}static table(){return R("table")}static caption(e,n,r){return R("caption",R("p",`Date: ${e}`),R("p",`Tasks: ${n}`),R("p",`Estimated: ${Ve(r)}`))}static head(){return R("tr",R("th","Task"),R("th","Count"),R("th","Estimated"))}static tr(e){return R("tr",R("td",e.type),R("td",`${e.count}`),R("td",Ve(e.estimated)))}static open(e){const n=new Blob([e.outerHTML],{type:"text/html"});R("a",{target:"_blank",href:URL.createObjectURL(n)}).click()}}class Sr{generateMonthyPage(){}generateDailyPage(){const e=ft.page();for(const{date:n,list:r,total:o,estimated:i}of Rt.taskList){const s=ft.table(),a=ft.caption(n,o,i);s.append(a);const c=ft.head();s.append(c);for(const p of r){const d=ft.tr(p);s.append(d)}e.prepend(s)}ft.open(e)}}const Ge=new Sr;function ce({label:t,position:e="bottom",size:n="large"}){return{"aria-label":t,"data-microtip-size":n,"data-microtip-position":e,role:"tooltip"}}const kr=et("<button>A"),[ue,Dr]=G(!0);class Mr{get isAutoSubmit(){return ue()}toggle(){Dr(!ue())}}const wt=new Mr,Or=()=>(()=>{const t=kr();return ne(t,Nt(()=>ce({label:"Auto submit",position:"left",size:"medium"}),{get classList(){return{enabled:ue()}},onClick:()=>wt.toggle()}),!1,!0),t})(),fe=Symbol("store-raw"),dt=Symbol("store-node"),nt=Symbol("store-has"),Ke=Symbol("store-self");function Ze(t){let e=t[Z];if(!e&&(Object.defineProperty(t,Z,{value:e=new Proxy(t,Cr)}),!Array.isArray(t))){const n=Object.keys(t),r=Object.getOwnPropertyDescriptors(t);for(let o=0,i=n.length;o<i;o++){const s=n[o];r[s].get&&Object.defineProperty(t,s,{enumerable:r[s].enumerable,get:r[s].get.bind(e)})}}return e}function zt(t){let e;return t!=null&&typeof t=="object"&&(t[Z]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function xt(t,e=new Set){let n,r,o,i;if(n=t!=null&&t[fe])return n;if(!zt(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,a=t.length;s<a;s++)o=t[s],(r=xt(o,e))!==o&&(t[s]=r)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),a=Object.getOwnPropertyDescriptors(t);for(let c=0,p=s.length;c<p;c++)i=s[c],!a[i].get&&(o=t[i],(r=xt(o,e))!==o&&(t[i]=r))}return t}function Yt(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function $t(t,e,n){if(t[e])return t[e];const[r,o]=G(n,{equals:!1,internal:!0});return r.$=o,t[e]=r}function Ar(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===Z||e===dt||(delete n.value,delete n.writable,n.get=()=>t[Z][e]),n}function Xe(t){Zt()&&$t(Yt(t,dt),Ke)()}function Er(t){return Xe(t),Reflect.ownKeys(t)}const Cr={get(t,e,n){if(e===fe)return t;if(e===Z)return n;if(e===be)return Xe(t),n;const r=Yt(t,dt),o=r[e];let i=o?o():t[e];if(e===dt||e===nt||e==="__proto__")return i;if(!o){const s=Object.getOwnPropertyDescriptor(t,e);Zt()&&(typeof i!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(i=$t(r,e,i)())}return zt(i)?Ze(i):i},has(t,e){return e===fe||e===Z||e===be||e===dt||e===nt||e==="__proto__"?!0:(Zt()&&$t(Yt(t,nt),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Er,getOwnPropertyDescriptor:Ar};function Bt(t,e,n,r=!1){if(!r&&t[e]===n)return;const o=t[e],i=t.length;n===void 0?(delete t[e],t[nt]&&t[nt][e]&&o!==void 0&&t[nt][e].$()):(t[e]=n,t[nt]&&t[nt][e]&&o===void 0&&t[nt][e].$());let s=Yt(t,dt),a;if((a=$t(s,e,o))&&a.$(()=>n),Array.isArray(t)&&t.length!==i){for(let c=t.length;c<i;c++)(a=s[c])&&a.$();(a=$t(s,"length",i))&&a.$(t.length)}(a=s[Ke])&&a.$()}function Je(t,e){const n=Object.keys(e);for(let r=0;r<n.length;r+=1){const o=n[r];Bt(t,o,e[o])}}function _r(t,e){if(typeof e=="function"&&(e=e(t)),e=xt(e),Array.isArray(e)){if(t===e)return;let n=0,r=e.length;for(;n<r;n++){const o=e[n];t[n]!==o&&Bt(t,n,o)}Bt(t,"length",r)}else Je(t,e)}function Tt(t,e,n=[]){let r,o=t;if(e.length>1){r=e.shift();const s=typeof r,a=Array.isArray(t);if(Array.isArray(r)){for(let c=0;c<r.length;c++)Tt(t,[r[c]].concat(e),n);return}else if(a&&s==="function"){for(let c=0;c<t.length;c++)r(t[c],c)&&Tt(t,[c].concat(e),n);return}else if(a&&s==="object"){const{from:c=0,to:p=t.length-1,by:d=1}=r;for(let h=c;h<=p;h+=d)Tt(t,[h].concat(e),n);return}else if(e.length>1){Tt(t[r],e,[r].concat(n));return}o=t[r],n=[r].concat(n)}let i=e[0];typeof i=="function"&&(i=i(o,n),i===o)||r===void 0&&i==null||(i=xt(i),r===void 0||zt(o)&&zt(i)&&!Array.isArray(i)?Je(o,i):Bt(t,r,i))}function Qe(...[t,e]){const n=xt(t||{}),r=Array.isArray(n),o=Ze(n);function i(...s){tt(()=>{r&&s.length===1?_r(n,s[0]):Tt(n,s)})}return[o,i]}const Ir=et("<div>");var qt=class{x;y;width;height;constructor(t){this.x=Math.floor(t.x),this.y=Math.floor(t.y),this.width=Math.floor(t.width),this.height=Math.floor(t.height)}get rect(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get center(){return{x:this.x+this.width*.5,y:this.y+this.height*.5}}get corners(){return{topLeft:{x:this.left,y:this.top},topRight:{x:this.right,y:this.top},bottomRight:{x:this.left,y:this.bottom},bottomLeft:{x:this.right,y:this.bottom}}}},St=t=>{let e=new qt(t.getBoundingClientRect());const{transform:n}=getComputedStyle(t);return n&&(e=Lr(e,n)),e},Lr=(t,e)=>{let n,r;if(e.startsWith("matrix3d(")){const o=e.slice(9,-1).split(/, /);n=+o[12],r=+o[13]}else if(e.startsWith("matrix(")){const o=e.slice(7,-1).split(/, /);n=+o[4],r=+o[5]}else n=0,r=0;return new qt({...t,x:t.x-n,y:t.y-r})},gt=()=>({x:0,y:0}),Pr=(t,e)=>t.x===e.x&&t.y===e.y,de=(t,e)=>new qt({...t,x:t.x+e.x,y:t.y+e.y}),Nr=(t,e)=>{const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.right,e.right),i=Math.min(t.bottom,e.bottom),s=o-r,a=i-n;if(r<o&&n<i){const c=t.width*t.height,p=e.width*e.height,d=s*a;return d/(c+p-d)}return 0},ge=(t,e)=>t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height,jr=(t,e,n)=>{const r=t.transformed,o={ratio:0,droppable:null};for(const i of e){const s=Nr(r,i.layout);s>o.ratio?(o.ratio=s,o.droppable=i):s>0&&s===o.ratio&&i.id===n.activeDroppableId&&(o.droppable=i)}return o.droppable},tn=Mn(),Ur=t=>{const e=Nt({collisionDetector:jr},t),[n,r]=Qe({draggables:{},droppables:{},sensors:{},active:{draggableId:null,get draggable(){return n.active.draggableId!==null?n.draggables[n.active.draggableId]:null},droppableId:null,get droppable(){return n.active.droppableId!==null?n.droppables[n.active.droppableId]:null},sensorId:null,get sensor(){return n.active.sensorId!==null?n.sensors[n.active.sensorId]:null},overlay:null}}),o=(l,u,f)=>{l.substring(0,l.length-1),j(()=>n[l][u])&&r(l,u,"transformers",f.id,f)},i=(l,u,f)=>{l.substring(0,l.length-1),j(()=>n[l][u])&&j(()=>n[l][u].transformers[f])&&r(l,u,"transformers",f,void 0)},s=({id:l,node:u,layout:f,data:y})=>{const g=n.draggables[l],m={id:l,node:u,layout:f,data:y,_pendingCleanup:!1};let v;if(!g)Object.defineProperties(m,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{if(n.active.overlay)return gt();const $=Object.values(n.draggables[l].transformers);return $.sort((M,_)=>M.order-_.order),$.reduce((M,_)=>_.callback(M),gt())}},transformed:{enumerable:!0,configurable:!0,get:()=>de(n.draggables[l].layout,n.draggables[l].transform)}});else if(n.active.draggableId===l&&!n.active.overlay){const $={x:g.layout.x-f.x,y:g.layout.y-f.y},M="addDraggable-existing-offset",_=g.transformers[M],F=_?_.callback($):$;v={id:M,order:100,callback:H=>({x:H.x+F.x,y:H.y+F.y})},k(()=>i("draggables",l,M))}tt(()=>{r("draggables",l,m),v&&o("draggables",l,v)}),n.active.draggable&&N()},a=l=>{j(()=>n.draggables[l])&&(r("draggables",l,"_pendingCleanup",!0),queueMicrotask(()=>c(l)))},c=l=>{if(n.draggables[l]?._pendingCleanup){const u=n.active.draggableId===l;tt(()=>{u&&r("active","draggableId",null),r("draggables",l,void 0)})}},p=({id:l,node:u,layout:f,data:y})=>{const g=n.droppables[l],m={id:l,node:u,layout:f,data:y,_pendingCleanup:!1};g||Object.defineProperties(m,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{const v=Object.values(n.droppables[l].transformers);return v.sort(($,M)=>$.order-M.order),v.reduce(($,M)=>M.callback($),gt())}},transformed:{enumerable:!0,configurable:!0,get:()=>de(n.droppables[l].layout,n.droppables[l].transform)}}),r("droppables",l,m),n.active.draggable&&N()},d=l=>{j(()=>n.droppables[l])&&(r("droppables",l,"_pendingCleanup",!0),queueMicrotask(()=>h(l)))},h=l=>{if(n.droppables[l]?._pendingCleanup){const u=n.active.droppableId===l;tt(()=>{u&&r("active","droppableId",null),r("droppables",l,void 0)})}},w=({id:l,activators:u})=>{r("sensors",l,{id:l,activators:u,coordinates:{origin:{x:0,y:0},current:{x:0,y:0},get delta(){return{x:n.sensors[l].coordinates.current.x-n.sensors[l].coordinates.origin.x,y:n.sensors[l].coordinates.current.y-n.sensors[l].coordinates.origin.y}}}})},x=l=>{if(!j(()=>n.sensors[l]))return;const u=n.active.sensorId===l;tt(()=>{u&&r("active","sensorId",null),r("sensors",l,void 0)})},T=({node:l,layout:u})=>{const f=n.active.overlay,y={node:l,layout:u};f||Object.defineProperties(y,{id:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.id},data:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.data},transformers:{enumerable:!0,configurable:!0,get:()=>Object.fromEntries(Object.entries(n.active.draggable?n.active.draggable.transformers:{}).filter(([g])=>g!=="addDraggable-existing-offset"))},transform:{enumerable:!0,configurable:!0,get:()=>{const g=Object.values(n.active.overlay?n.active.overlay.transformers:[]);return g.sort((m,v)=>m.order-v.order),g.reduce((m,v)=>v.callback(m),gt())}},transformed:{enumerable:!0,configurable:!0,get:()=>n.active.overlay?de(n.active.overlay.layout,n.active.overlay.transform):new qt({x:0,y:0,width:0,height:0})}}),r("active","overlay",y)},b=()=>r("active","overlay",null),S=(l,u)=>{tt(()=>{r("sensors",l,"coordinates",{origin:{...u},current:{...u}}),r("active","sensorId",l)})},P=l=>{const u=n.active.sensorId;u&&r("sensors",u,"coordinates","current",{...l})},E=()=>r("active","sensorId",null),C=(l,u)=>{const f={};for(const g of Object.values(n.sensors))if(g)for(const[m,v]of Object.entries(g.activators))f[m]??=[],f[m].push({sensor:g,activator:v});const y={};for(const g in f){let m=g;u&&(m=`on${g}`),y[m]=v=>{for(const{activator:$}of f[g]){if(n.active.sensor)break;$(v,l)}}}return y},N=()=>{let l=!1;const u=Object.values(n.draggables),f=Object.values(n.droppables),y=n.active.overlay;return tt(()=>{const g=new WeakMap;for(const m of u)if(m){const v=m.layout;g.has(m.node)||g.set(m.node,St(m.node));const $=g.get(m.node);ge(v,$)||(r("draggables",m.id,"layout",$),l=!0)}for(const m of f)if(m){const v=m.layout;g.has(m.node)||g.set(m.node,St(m.node));const $=g.get(m.node);ge(v,$)||(r("droppables",m.id,"layout",$),l=!0)}if(y){const m=y.layout,v=St(y.node);ge(m,v)||(r("active","overlay","layout",v),l=!0)}}),l},D=()=>{const l=n.active.overlay??n.active.draggable;if(l){const u=e.collisionDetector(l,Object.values(n.droppables),{activeDroppableId:n.active.droppableId}),f=u?u.id:null;n.active.droppableId!==f&&r("active","droppableId",f)}},L=l=>{const u={id:"sensorMove",order:0,callback:f=>n.active.sensor?{x:f.x+n.active.sensor.coordinates.delta.x,y:f.y+n.active.sensor.coordinates.delta.y}:f};N(),tt(()=>{r("active","draggableId",l),o("draggables",l,u)}),D()},z=()=>{const l=j(()=>n.active.draggableId);tt(()=>{l!==null&&i("draggables",l,"sensorMove"),r("active",["draggableId","droppableId"],null)}),N()},W=l=>{Q(()=>{const u=n.active.draggable;u&&j(()=>l({draggable:u}))})},B=l=>{Q(()=>{const u=n.active.draggable;if(u){const f=j(()=>n.active.overlay);Object.values(f?f.transform:u.transform),j(()=>l({draggable:u,overlay:f}))}})},A=l=>{Q(()=>{const u=n.active.draggable,f=n.active.droppable;u&&j(()=>l({draggable:u,droppable:f,overlay:n.active.overlay}))})},k=l=>{Q(({previousDraggable:u,previousDroppable:f,previousOverlay:y})=>{const g=n.active.draggable,m=g?n.active.droppable:null,v=g?n.active.overlay:null;return!g&&u&&j(()=>l({draggable:u,droppable:f,overlay:y})),{previousDraggable:g,previousDroppable:m,previousOverlay:v}},{previousDraggable:null,previousDroppable:null,previousOverlay:null})};B(()=>D()),e.onDragStart&&W(e.onDragStart),e.onDragMove&&B(e.onDragMove),e.onDragOver&&A(e.onDragOver),e.onDragEnd&&k(e.onDragEnd);const Vt=[n,{addTransformer:o,removeTransformer:i,addDraggable:s,removeDraggable:a,addDroppable:p,removeDroppable:d,addSensor:w,removeSensor:x,setOverlay:T,clearOverlay:b,recomputeLayouts:N,detectCollisions:D,draggableActivators:C,sensorStart:S,sensorMove:P,sensorEnd:E,dragStart:L,dragEnd:z,onDragStart:W,onDragMove:B,onDragOver:A,onDragEnd:k}];return Y(tn.Provider,{value:Vt,get children(){return e.children}})},he=()=>On(tn)||null,Fr=(t="pointer-sensor")=>{const[e,{addSensor:n,removeSensor:r,sensorStart:o,sensorMove:i,sensorEnd:s,dragStart:a,dragEnd:c}]=he(),p=250,d=10;xe(()=>{n({id:t,activators:{pointerdown:b}})}),mt(()=>{r(t)});const h=()=>e.active.sensorId===t,w={x:0,y:0};let x=null,T=null;const b=(D,L)=>{D.button===0&&(document.addEventListener("pointermove",E),document.addEventListener("pointerup",C),T=L,w.x=D.clientX,w.y=D.clientY,x=window.setTimeout(P,p))},S=()=>{x&&(clearTimeout(x),x=null),document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",C),document.removeEventListener("selectionchange",N)},P=()=>{e.active.sensor?h()||S():(o(t,w),a(T),N(),document.addEventListener("selectionchange",N))},E=D=>{const L={x:D.clientX,y:D.clientY};if(!e.active.sensor){const z={x:L.x-w.x,y:L.y-w.y};Math.sqrt(z.x**2+z.y**2)>d&&P()}h()&&(D.preventDefault(),i(L))},C=D=>{S(),h()&&(D.preventDefault(),c(),s())},N=()=>{window.getSelection()?.removeAllRanges()}},Rr=t=>(Fr(),K(()=>t.children)),en=t=>({transform:`translate3d(${t.x}px, ${t.y}px, 0)`}),zr=(t,e={})=>{const[n,{addDraggable:r,removeDraggable:o,draggableActivators:i}]=he(),[s,a]=G(null);xe(()=>{const h=s();h&&r({id:t,node:h,layout:St(h),data:e})}),mt(()=>o(t));const c=()=>n.active.draggableId===t,p=()=>n.draggables[t]?.transform||gt();return Object.defineProperties((h,w)=>{const x=w?w():{};Q(()=>{const T=s(),b=i(t);if(T)for(const S in b)T.addEventListener(S,b[S]);mt(()=>{if(T)for(const S in b)T.removeEventListener(S,b[S])})}),a(h),x.skipTransform||Q(()=>{const T=p();if(Pr(T,gt()))h.style.removeProperty("transform");else{const b=en(p());h.style.setProperty("transform",b.transform??null)}})},{ref:{enumerable:!0,value:a},isActiveDraggable:{enumerable:!0,get:c},dragActivators:{enumerable:!0,get:()=>i(t,!0)},transform:{enumerable:!0,get:p}})},Yr=t=>{const[e,{onDragStart:n,onDragEnd:r,setOverlay:o,clearOverlay:i}]=he();let s;n(({draggable:c})=>{o({node:c.node,layout:c.layout}),queueMicrotask(()=>{if(s){const p=St(s),d={x:(c.layout.width-p.width)/2,y:(c.layout.height-p.height)/2};p.x+=d.x,p.y+=d.y,o({node:s,layout:p})}})}),r(()=>queueMicrotask(i));const a=()=>{const c=e.active.overlay,p=e.active.draggable;return!c||!p?{}:{position:"fixed",transition:"transform 0s",top:`${c.layout.top}px`,left:`${c.layout.left}px`,"min-width":`${p.layout.width}px`,"min-height":`${p.layout.height}px`,...en(c.transform),...t.style}};return Y(nr,{get mount(){return document.body},get children(){return Y(De,{get when(){return e.active.draggable},get children(){const c=Ir(),p=s;return typeof p=="function"?Ce(p,c):s=c,ot(c,(()=>{const d=K(()=>typeof t.children=="function");return()=>d()?t.children(e.active.draggable):t.children})()),J(d=>{const h=t.class,w=a();return h!==d._v$&&Ae(c,d._v$=h),d._v$2=Ee(c,w,d._v$2),d},{_v$:void 0,_v$2:void 0}),c}})}})};function pe(t,e){const n=GM_getValue(t,e),[r,o]=Qe(n);return Q(()=>GM_setValue(t,r)),[r,o]}const Br=et('<div class="tryrating-widget draggable absolute">'),qr=et("<div class=widget-drag-overlay><span class=text>alt+3 reset position"),[nn,rn]=pe("widget-position",{top:"0px",left:"0px"});function Hr(){rn({top:"0px",left:"0px"})}const Wr=t=>{const e=zr(t.id);return(()=>{const n=Br();return Ce(e,n,()=>!0),ot(n,()=>t.children),J(r=>{const o=!!e.isActiveDraggable,i=nn.top,s=nn.left;return o!==r._v$&&n.classList.toggle("opacity-25",r._v$=o),i!==r._v$2&&((r._v$2=i)!=null?n.style.setProperty("top",i):n.style.removeProperty("top")),s!==r._v$3&&((r._v$3=s)!=null?n.style.setProperty("left",s):n.style.removeProperty("left")),r},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()},Vr=t=>{let e={x:0,y:0};return Y(Ur,{onDragMove:({overlay:o})=>{o&&(e={...o.transform})},onDragEnd:({draggable:o})=>{const i=o.node,s=`${i.offsetTop+e.y}px`,a=`${i.offsetLeft+e.x}px`;rn({top:s,left:a})},get children(){return[Y(Rr,{}),Y(Wr,{id:1,get children(){return t.children}}),Y(Yr,{children:o=>[qr(),o]})]}})},[on,Gr]=G(!0);function Kr(){Gr(!on())}const Zr=t=>Y(De,{get when(){return on()},get children(){return t.children}});function Xr(){window.addEventListener("keydown",t=>{yt.openTasks(t)&&(t.preventDefault(),Ge.generateDailyPage()),yt.resetTasks(t)&&(t.preventDefault(),confirm(`Reset data.
Are you sure?`)&&Rt.reset()),yt.resetWidgetPosition(t)&&(t.preventDefault(),Hr()),yt.toggleAutoSubmit(t)&&(t.preventDefault(),wt.toggle()),yt.toggleWidgetVisibility(t)&&(t.preventDefault(),Kr())})}const Jr=t=>(e,n)=>(t.set(e,n),n),sn=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,an=536870912,ln=an*2,Qr=(t,e)=>n=>{const r=e.get(n);let o=r===void 0?n.size:r<ln?r+1:0;if(!n.has(o))return t(n,o);if(n.size<an){for(;n.has(o);)o=Math.floor(Math.random()*ln);return t(n,o)}if(n.size>sn)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(o);)o=Math.floor(Math.random()*sn);return t(n,o)},cn=new WeakMap,to=Jr(cn),Ht=Qr(to,cn),eo=t=>t.method!==void 0&&t.method==="call",no=t=>t.error===null&&typeof t.id=="number",un=((t,e)=>{let n=null;return()=>{if(n!==null)return n;const r=new Blob([e],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return n=t(o),setTimeout(()=>URL.revokeObjectURL(o)),n}})(t=>{const e=new Map([[0,()=>{}]]),n=new Map([[0,()=>{}]]),r=new Map,o=new Worker(t);return o.addEventListener("message",({data:p})=>{if(eo(p)){const{params:{timerId:d,timerType:h}}=p;if(h==="interval"){const w=e.get(d);if(typeof w=="number"){const x=r.get(w);if(x===void 0||x.timerId!==d||x.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof w<"u")w();else throw new Error("The timer is in an undefined state.")}else if(h==="timeout"){const w=n.get(d);if(typeof w=="number"){const x=r.get(w);if(x===void 0||x.timerId!==d||x.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof w<"u")w(),n.delete(d);else throw new Error("The timer is in an undefined state.")}}else if(no(p)){const{id:d}=p,h=r.get(d);if(h===void 0)throw new Error("The timer is in an undefined state.");const{timerId:w,timerType:x}=h;r.delete(d),x==="interval"?e.delete(w):n.delete(w)}else{const{error:{message:d}}=p;throw new Error(d)}}),{clearInterval:p=>{const d=Ht(r);r.set(d,{timerId:p,timerType:"interval"}),e.set(p,d),o.postMessage({id:d,method:"clear",params:{timerId:p,timerType:"interval"}})},clearTimeout:p=>{const d=Ht(r);r.set(d,{timerId:p,timerType:"timeout"}),n.set(p,d),o.postMessage({id:d,method:"clear",params:{timerId:p,timerType:"timeout"}})},setInterval:(p,d)=>{const h=Ht(e);return e.set(h,()=>{p(),typeof e.get(h)=="function"&&o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"interval"}})}),o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"interval"}}),h},setTimeout:(p,d)=>{const h=Ht(n);return n.set(h,p),o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"timeout"}}),h}}},`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`),fn=t=>un().clearInterval(t),me=(t,e)=>un().setInterval(t,e),ro=".modal-container.visible",oo="div[modalwrapref] > div",dn="Validation failed!",[gn,io]=pe("auto-close-modal",{value:!0});class so{get autoClose(){return gn.value}toggleAutoClose(){io({value:!gn.value})}closeValidationFailed(){const e=document.querySelector(ro);if(!e)return;const n=e.querySelector(oo);if(n&&n.textContent===dn){GM_notification({title:document.title,text:dn,highlight:!0,silent:!1,timeout:1e3});const r=e.querySelector("button");r&&(U.info("Modal closed"),r.click())}}}const Wt=new so,[hn,pn]=pe("check-survey",{value:!1}),[ao,lo]=G(!1);class co{checkSurvey(){if(ao())return;const e=document.querySelector(".no-survey-view");if(!e)return;const n=e.querySelector("button");if(!n){U.info("Check Now button is not defined");return}hn.value||(U.info("Survey is not found. Please, wait..."),pn({value:!0})),lo(!0),Fe(1e4).then(()=>n.click()).finally(()=>this.reloadPage())}tryNotification(){if(!hn.value)return;pn({value:!1}),GM_notification({title:"Survey found!",text:"Go to the survey",highlight:!0,timeout:3e3});const e=new Audio(ir);e.volume=.3,e.play()}reloadPage(){const e=Re(3e4,6e4);Fe(e).then(()=>location.reload())}}const mn=new co;function uo(t){const e=t.split(/\s(?=\d)/);let n=0;for(const r of e){const[o,i]=r.split(" ");switch(i){case"hours":n+=Number(o)*36e5;break;case"minute":case"minutes":n+=Number(o)*6e4;break;case"second":case"seconds":n+=Number(o)*1e3;break;default:U.warn(`Unknown time type: ${i}`)}}return n}function bn(t){const e=Re(-5,15);return t+e*1e3}const[fo,yn]=G(0);let go=class{intervalId;get time(){return fo()}tick(){yn(e=>e+1e3)}start(){this.intervalId&&(fn(this.intervalId),yn(0)),this.intervalId=me(()=>this.tick(),1e3)}};const vn=new go,ho=".btn-success",po="Submit Rating",[wn,mo]=G(!0);class bo{get isAutoSubmit(){return wn()}toggleAutoSubmit(){mo(!wn())}getSubmitButtons(){const e=[],n=Array.from(document.querySelectorAll(ho));for(const r of n)r instanceof HTMLButtonElement&&r.textContent===po&&e.push(r);return e}clickSubmit(){if(!wt.isAutoSubmit)return;const e=this.getSubmitButtons();if(!e.length){U.error("Submit button is not defined");return}e[0].click()}}const yo=new bo,[xn,$n]=G(0);let vo=class{intervalId;onTimerTickCallback;onEndCallback;tick(){const e=xn()-1e3;$n(e),this.onTimerTickCallback(),e===0&&(this.onEndCallback(),this.stop())}get time(){return xn()}onTimerEnd(e){this.onEndCallback=e}onTimerTick(e){this.onTimerTickCallback=e}start(e){this.stop(),$n(e),this.intervalId=me(()=>this.tick(),1e3)}stop(){this.intervalId&&(fn(this.intervalId),this.intervalId=null)}};const kt=new vo;kt.onTimerEnd(()=>yo.clickSubmit()),kt.onTimerTick(()=>{const t=ht.getTaskFields,e=ht.currentTaskFields;if(!(!t||!e)&&e.requestId===t.requestId&&e.estimated!==t.estimated){U.info("Task estimated changed",{oldTaskFields:e,newTaskFields:t});const n=bn(t.estimated);kt.start(n),ht.currentTaskFields=t}});class wo{taskFields=null;onChangeTaskCallback=null;get currentTaskFields(){return this.taskFields}set currentTaskFields(e){this.taskFields=e}get getTaskFields(){const e=document.querySelector(this.targetSelector);if(!e){U.error("Task fields not found");return}const[n,r,o]=Array.from(e.querySelectorAll(".labeled-attribute__attribute"));if(!n||!r||!o){U.error("Task fields attributes not found");return}return{taskType:n.textContent,requestId:r.textContent,estimated:uo(o.textContent.trim())}}get targetSelector(){return".survey-meta-fields"}onChangeTask(e){this.onChangeTaskCallback=e}observe(){const e=this.getTaskFields;if(e&&e.requestId!==this.taskFields?.requestId){const n=bn(e.estimated);U.info("Task fields changed",e),this.onChangeTaskCallback({...e,estimated:n}),wt.isAutoSubmit||wt.toggle(),this.taskFields&&(U.info("Task is submitted",this.taskFields),Rt.write({type:this.taskFields.taskType,estimated:this.taskFields.estimated})),this.currentTaskFields=e}}}const ht=new wo;ht.onChangeTask(t=>{kt.start(t.estimated),vn.start(),ze.checkUpdates(),mn.tryNotification()});async function xo(){const t=document.querySelector("#app-root");if(!t){U.error("App root not found");return}Be(t,()=>{Wt.autoClose&&Wt.closeValidationFailed(),mn.checkSurvey()}),qe({selector:ht.targetSelector}).then(()=>{me(()=>ht.observe(),7*1e3)}).finally(()=>U.info("Initialized task fields observer"))}const $o=et("<button>M"),To=()=>(()=>{const t=$o();return ne(t,Nt(()=>ce({label:"Auto close",position:"left",size:"medium"}),{get classList(){return{enabled:Wt.autoClose}},onClick:()=>Wt.toggleAutoClose()}),!1,!0),t})(),So=et("<button class=task-counter>"),ko=()=>{const t=K(()=>{const e=Ut();return Rt.taskList.find(r=>r.date===e)?.total??"0"});return(()=>{const e=So();return e.$$click=()=>Ge.generateDailyPage(),ot(e,t),e})()};Oe(["click"]);const Do=et("<div>?"),Mo=()=>(()=>{const t=Do();return ne(t,Nt(()=>ce({label:sr,position:"left",size:"large"})),!1,!0),t})(),Oo=et("<div>Stopwatch: "),Ao=()=>{const t=K(()=>We(vn.time));return(()=>{const e=Oo();return e.firstChild,ot(e,t,null),e})()},Eo=et("<div>Timer: "),Co=()=>{const t=K(()=>We(kt.time));return(()=>{const e=Eo();return e.firstChild,ot(e,t,null),e})()},_o=()=>Y(Zr,{get children(){return Y(Vr,{get children(){return[Y(Co,{}),Y(Ao,{}),Y(ko,{}),Y(Or,{}),Y(To,{}),Y(Mo,{})]}})}});xo(),Xr(),Vn(()=>Y(_o,{}),document.body),GM_addStyle('[aria-label][role~=tooltip]{position:relative}[aria-label][role~=tooltip]:before,[aria-label][role~=tooltip]:after{transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden;will-change:transform;opacity:0;pointer-events:none;transition:all var(--microtip-transition-duration, .18s) var(--microtip-transition-easing, ease-in-out) var(--microtip-transition-delay, 0s);position:absolute;box-sizing:border-box;z-index:10;transform-origin:top}[aria-label][role~=tooltip]:before{background-size:100% auto!important;content:""}[aria-label][role~=tooltip]:after{background:#111111e6;border-radius:4px;color:#fff;content:attr(aria-label);font-size:var(--microtip-font-size, 13px);font-weight:var(--microtip-font-weight, normal);text-transform:var(--microtip-text-transform, none);padding:.5em 1em;white-space:nowrap;box-sizing:content-box}[aria-label][role~=tooltip]:hover:before,[aria-label][role~=tooltip]:hover:after,[aria-label][role~=tooltip]:focus:before,[aria-label][role~=tooltip]:focus:after{opacity:1;pointer-events:auto}[role~=tooltip][data-microtip-position|=top]:before{background:url(data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%280%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E) no-repeat;height:6px;width:18px;margin-bottom:5px}[role~=tooltip][data-microtip-position|=top]:after{margin-bottom:11px}[role~=tooltip][data-microtip-position|=top]:before{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~=tooltip][data-microtip-position|=top]:hover:before{transform:translate3d(-50%,-5px,0)}[role~=tooltip][data-microtip-position|=top]:after{transform:translate3d(-50%,0,0);bottom:100%;left:50%}[role~=tooltip][data-microtip-position=top]:hover:after{transform:translate3d(-50%,-5px,0)}[role~=tooltip][data-microtip-position=top-left]:after{transform:translate3d(calc(-100% + 16px),0,0);bottom:100%}[role~=tooltip][data-microtip-position=top-left]:hover:after{transform:translate3d(calc(-100% + 16px),-5px,0)}[role~=tooltip][data-microtip-position=top-right]:after{transform:translate3d(calc(0% - 16px),0,0);bottom:100%}[role~=tooltip][data-microtip-position=top-right]:hover:after{transform:translate3d(calc(0% - 16px),-5px,0)}[role~=tooltip][data-microtip-position|=bottom]:before{background:url(data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2236px%22%20height%3D%2212px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28180%2018%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E) no-repeat;height:6px;width:18px;margin-top:5px;margin-bottom:0}[role~=tooltip][data-microtip-position|=bottom]:after{margin-top:11px}[role~=tooltip][data-microtip-position|=bottom]:before{transform:translate3d(-50%,-10px,0);bottom:auto;left:50%;top:100%}[role~=tooltip][data-microtip-position|=bottom]:hover:before{transform:translate3d(-50%,0,0)}[role~=tooltip][data-microtip-position|=bottom]:after{transform:translate3d(-50%,-10px,0);top:100%;left:50%}[role~=tooltip][data-microtip-position=bottom]:hover:after{transform:translate3d(-50%,0,0)}[role~=tooltip][data-microtip-position=bottom-left]:after{transform:translate3d(calc(-100% + 16px),-10px,0);top:100%}[role~=tooltip][data-microtip-position=bottom-left]:hover:after{transform:translate3d(calc(-100% + 16px),0,0)}[role~=tooltip][data-microtip-position=bottom-right]:after{transform:translate3d(calc(0% - 16px),-10px,0);top:100%}[role~=tooltip][data-microtip-position=bottom-right]:hover:after{transform:translate3d(calc(0% - 16px),0,0)}[role~=tooltip][data-microtip-position=left]:before,[role~=tooltip][data-microtip-position=left]:after{inset:50% 100% auto auto;transform:translate3d(10px,-50%,0)}[role~=tooltip][data-microtip-position=left]:before{background:url(data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%28-90%2018%2018%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E) no-repeat;height:18px;width:6px;margin-right:5px;margin-bottom:0}[role~=tooltip][data-microtip-position=left]:after{margin-right:11px}[role~=tooltip][data-microtip-position=left]:hover:before,[role~=tooltip][data-microtip-position=left]:hover:after{transform:translate3d(0,-50%,0)}[role~=tooltip][data-microtip-position=right]:before,[role~=tooltip][data-microtip-position=right]:after{bottom:auto;left:100%;top:50%;transform:translate3d(-10px,-50%,0)}[role~=tooltip][data-microtip-position=right]:before{background:url(data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2212px%22%20height%3D%2236px%22%3E%3Cpath%20fill%3D%22rgba%2817,%2017,%2017,%200.9%29%22%20transform%3D%22rotate%2890%206%206%29%22%20d%3D%22M2.658,0.000%20C-13.615,0.000%2050.938,0.000%2034.662,0.000%20C28.662,0.000%2023.035,12.002%2018.660,12.002%20C14.285,12.002%208.594,0.000%202.658,0.000%20Z%22/%3E%3C/svg%3E) no-repeat;height:18px;width:6px;margin-bottom:0;margin-left:5px}[role~=tooltip][data-microtip-position=right]:after{margin-left:11px}[role~=tooltip][data-microtip-position=right]:hover:before,[role~=tooltip][data-microtip-position=right]:hover:after{transform:translate3d(0,-50%,0)}[role~=tooltip][data-microtip-size=small]:after{white-space:initial;width:80px}[role~=tooltip][data-microtip-size=medium]:after{white-space:initial;width:150px}[role~=tooltip][data-microtip-size=large]:after{white-space:initial;width:260px}:root{--try-font-family: monospace}.tryrating-widget{user-select:none;display:flex;color:#fff;padding-left:4px;background:#2e2c2f;font-size:1rem;font-weight:600;align-items:center;height:40px;justify-content:center;text-transform:uppercase;font-family:var(--try-font-family)}.tryrating-widget.draggable{cursor:pointer}.tryrating-widget.absolute{z-index:999999;position:absolute}.tryrating-widget.opacity-25{opacity:.25}.tryrating-widget>.task-counter{background:gray}.tryrating-widget>div{margin-left:6px;margin-right:6px}.tryrating-widget>button{text-transform:inherit;height:inherit;border:none;font-size:inherit;font-weight:inherit;color:#fff;padding-left:12px;padding-right:12px;background:#f44336}.tryrating-widget>button.enabled{background:#4caf50}.widget-drag-overlay{font-size:20px;font-weight:700;color:#3b99fc;width:100%;height:100%;position:absolute;text-align:center;align-self:center;text-transform:uppercase;background:#000000e6}.widget-drag-overlay>.text{font-family:var(--try-font-family);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%}')})();
