// ==UserScript==
// @name        tryrating-userscript
// @version     1.4.0
// @author      crashmax <userscript@crashmax.ru>
// @license     MIT
// @homepage    https://crashmax-dev.github.io/tryrating-userscript/
// @match       https://www.tryrating.com/app/survey/*
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_addStyle
// @grant       GM_notification
// @updateURL   https://crashmax-dev.github.io/tryrating-userscript/tryrating-userscript.meta.js
// @downloadURL https://crashmax-dev.github.io/tryrating-userscript/tryrating-userscript.user.js
// ==/UserScript==

(function(){"use strict";const on={context:void 0,registry:void 0},an=(e,t)=>e===t,G=Symbol("solid-proxy"),ct=Symbol("solid-track"),xe={equals:an};let ft=bt;const ne=1,Oe=2,dt={owned:null,cleanups:null,context:null,owner:null};var I=null;let Ue=null,C=null,U=null,Z=null,De=0;function gt(e,t){const n=C,r=I,s=e.length===0,o=s?dt:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},i=s?e:()=>e(()=>R(()=>Ae(o)));I=o,C=null;try{return oe(i,!0)}finally{C=n,I=r}}function J(e,t){t=t?Object.assign({},xe,t):xe;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),yt(n,s));return[mt.bind(n),r]}function se(e,t,n){const r=ze(e,t,!1,ne);me(r)}function Q(e,t,n){ft=pn;const r=ze(e,t,!1,ne);(!n||!n.render)&&(r.user=!0),Z?Z.push(r):me(r)}function q(e,t,n){n=n?Object.assign({},xe,n):xe;const r=ze(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,me(r),mt.bind(r)}function ee(e){return oe(e,!1)}function R(e){if(C===null)return e();const t=C;C=null;try{return e()}finally{C=t}}function ht(e){Q(()=>R(e))}function pe(e){return I===null||(I.cleanups===null?I.cleanups=[e]:I.cleanups.push(e)),e}function pt(){return C}function ln(){return I}function un(e,t){const n=I,r=C;I=e,C=null;try{return oe(t,!0)}catch(s){Be(s)}finally{I=n,C=r}}function cn(e,t){const n=Symbol("context");return{id:n,Provider:yn(n),defaultValue:e}}function fn(e){let t;return(t=wt(I,e.id))!==void 0?t:e.defaultValue}function dn(e){const t=q(e),n=q(()=>We(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function mt(){if(this.sources&&this.state)if(this.state===ne)me(this);else{const e=U;U=null,oe(()=>ke(this),!1),U=e}if(C){const e=this.observers?this.observers.length:0;C.sources?(C.sources.push(this),C.sourceSlots.push(e)):(C.sources=[this],C.sourceSlots=[e]),this.observers?(this.observers.push(C),this.observerSlots.push(C.sources.length-1)):(this.observers=[C],this.observerSlots=[C.sources.length-1])}return this.value}function yt(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&oe(()=>{for(let s=0;s<e.observers.length;s+=1){const o=e.observers[s],i=Ue&&Ue.running;i&&Ue.disposed.has(o),(i?!o.tState:!o.state)&&(o.pure?U.push(o):Z.push(o),o.observers&&vt(o)),i||(o.state=ne)}if(U.length>1e6)throw U=[],new Error},!1)),t}function me(e){if(!e.fn)return;Ae(e);const t=I,n=C,r=De;C=I=e,gn(e,e.value,r),C=n,I=t}function gn(e,t,n){let r;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=ne,e.owned&&e.owned.forEach(Ae),e.owned=null),e.updatedAt=n+1,Be(s)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?yt(e,r):e.value=r,e.updatedAt=n)}function ze(e,t,n,r=ne,s){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:null,pure:n};return I===null||I!==dt&&(I.owned?I.owned.push(o):I.owned=[o]),o}function Me(e){if(e.state===0)return;if(e.state===Oe)return ke(e);if(e.suspense&&R(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<De);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ne)me(e);else if(e.state===Oe){const r=U;U=null,oe(()=>ke(e,t[0]),!1),U=r}}function oe(e,t){if(U)return e();let n=!1;t||(U=[]),Z?n=!0:Z=[],De++;try{const r=e();return hn(n),r}catch(r){n||(Z=null),U=null,Be(r)}}function hn(e){if(U&&(bt(U),U=null),e)return;const t=Z;Z=null,t.length&&oe(()=>ft(t),!1)}function bt(e){for(let t=0;t<e.length;t++)Me(e[t])}function pn(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Me(r)}for(t=0;t<n;t++)Me(e[t])}function ke(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===ne?r!==t&&(!r.updatedAt||r.updatedAt<De)&&Me(r):s===Oe&&ke(r,t)}}}function vt(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Oe,n.pure?U.push(n):Z.push(n),n.observers&&vt(n))}}function Ae(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const o=s.pop(),i=n.observerSlots.pop();r<s.length&&(o.sourceSlots[i]=r,s[r]=o,n.observerSlots[r]=i)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Ae(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function mn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Be(e,t=I){throw mn(e)}function wt(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:wt(e.owner,t):void 0}function We(e){if(typeof e=="function"&&!e.length)return We(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=We(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function yn(e,t){return function(r){let s;return se(()=>s=R(()=>(I.context={[e]:r.value},dn(()=>r.children))),void 0),s}}function H(e,t){return R(()=>e(t||{}))}function Ee(){return!0}const bn={get(e,t,n){return t===G?n:e.get(t)},has(e,t){return t===G?!0:e.has(t)},set:Ee,deleteProperty:Ee,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Ee,deleteProperty:Ee}},ownKeys(e){return e.keys()}};function He(e){return(e=typeof e=="function"?e():e)?e:{}}function vn(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function wn(...e){let t=!1;for(let o=0;o<e.length;o++){const i=e[o];t=t||!!i&&G in i,e[o]=typeof i=="function"?(t=!0,q(i)):i}if(t)return new Proxy({get(o){for(let i=e.length-1;i>=0;i--){const u=He(e[i])[o];if(u!==void 0)return u}},has(o){for(let i=e.length-1;i>=0;i--)if(o in He(e[i]))return!0;return!1},keys(){const o=[];for(let i=0;i<e.length;i++)o.push(...Object.keys(He(e[i])));return[...new Set(o)]}},bn);const n={},r={},s=new Set;for(let o=e.length-1;o>=0;o--){const i=e[o];if(!i)continue;const u=Object.getOwnPropertyNames(i);for(let c=0,h=u.length;c<h;c++){const d=u[c];if(d==="__proto__"||d==="constructor")continue;const p=Object.getOwnPropertyDescriptor(i,d);if(!s.has(d))p.get?(s.add(d),Object.defineProperty(n,d,{enumerable:!0,configurable:!0,get:vn.bind(r[d]=[p.get.bind(i)])})):(p.value!==void 0&&s.add(d),n[d]=p.value);else{const v=r[d];v?p.get?v.push(p.get.bind(i)):p.value!==void 0&&v.push(()=>p.value):n[d]===void 0&&(n[d]=p.value)}}}return n}const $n=e=>`Stale read from <${e}>.`;function $t(e){const t=e.keyed,n=q(()=>e.when,void 0,{equals:(r,s)=>t?r===s:!r==!s});return q(()=>{const r=n();if(r){const s=e.children;return typeof s=="function"&&s.length>0?R(()=>s(t?r:()=>{if(!R(n))throw $n("Show");return e.when})):s}return e.fallback},void 0,void 0)}function Tn(e,t,n){let r=n.length,s=t.length,o=r,i=0,u=0,c=t[s-1].nextSibling,h=null;for(;i<s||u<o;){if(t[i]===n[u]){i++,u++;continue}for(;t[s-1]===n[o-1];)s--,o--;if(s===i){const d=o<r?u?n[u-1].nextSibling:n[o-u]:c;for(;u<o;)e.insertBefore(n[u++],d)}else if(o===u)for(;i<s;)(!h||!h.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[o-1]&&n[u]===t[s-1]){const d=t[--s].nextSibling;e.insertBefore(n[u++],t[i++].nextSibling),e.insertBefore(n[--o],d),t[s]=n[o]}else{if(!h){h=new Map;let p=u;for(;p<o;)h.set(n[p],p++)}const d=h.get(t[i]);if(d!=null)if(u<d&&d<o){let p=i,v=1,$;for(;++p<s&&p<o&&!(($=h.get(t[p]))==null||$!==d+v);)v++;if(v>d-u){const S=t[i];for(;u<d;)e.insertBefore(n[u++],S)}else e.replaceChild(n[u++],t[i++])}else i++;else t[i++].remove()}}}const Tt="_$DX_DELEGATE";function Sn(e,t,n,r={}){let s;return gt(o=>{s=o,t===document?e():X(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{s(),t.textContent=""}}function ue(e,t,n){let r;const s=()=>{const i=document.createElement("template");return i.innerHTML=e,n?i.content.firstChild.firstChild:i.content.firstChild},o=t?()=>R(()=>document.importNode(r||(r=s()),!0)):()=>(r||(r=s())).cloneNode(!0);return o.cloneNode=o,o}function St(e,t=window.document){const n=t[Tt]||(t[Tt]=new Set);for(let r=0,s=e.length;r<s;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,Mn))}}function xn(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function On(e,t){t==null?e.removeAttribute("class"):e.className=t}function Dn(e,t,n){if(!t)return n?xn(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let s,o;for(o in n)t[o]==null&&r.removeProperty(o),delete n[o];for(o in t)s=t[o],s!==n[o]&&(r.setProperty(o,s),n[o]=s);return n}function xt(e,t,n){return R(()=>e(t,n))}function X(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return _e(e,t,r,n);se(s=>_e(e,t(),s,n),r)}function Mn(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n;){const r=n[t];if(r&&!n.disabled){const s=n[`${t}Data`];if(s!==void 0?r.call(n,s,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function _e(e,t,n,r,s){for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,o==="string"||o==="number")if(o==="number"&&(t=t.toString()),i){let u=n[0];u&&u.nodeType===3?u.data=t:u=document.createTextNode(t),n=ce(e,n,r,u)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||o==="boolean")n=ce(e,n,r);else{if(o==="function")return se(()=>{let u=t();for(;typeof u=="function";)u=u();n=_e(e,u,n,r)}),()=>n;if(Array.isArray(t)){const u=[],c=n&&Array.isArray(n);if(qe(u,t,n,s))return se(()=>n=_e(e,u,n,r,!0)),()=>n;if(u.length===0){if(n=ce(e,n,r),i)return n}else c?n.length===0?Ot(e,u,r):Tn(e,n,u):(n&&ce(e),Ot(e,u));n=u}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=ce(e,n,r,t);ce(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}else console.warn("Unrecognized value. Skipped inserting",t)}return n}function qe(e,t,n,r){let s=!1;for(let o=0,i=t.length;o<i;o++){let u=t[o],c=n&&n[o],h;if(!(u==null||u===!0||u===!1))if((h=typeof u)=="object"&&u.nodeType)e.push(u);else if(Array.isArray(u))s=qe(e,u,c)||s;else if(h==="function")if(r){for(;typeof u=="function";)u=u();s=qe(e,Array.isArray(u)?u:[u],Array.isArray(c)?c:[c])||s}else e.push(u),s=!0;else{const d=String(u);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return s}function Ot(e,t,n=null){for(let r=0,s=t.length;r<s;r++)e.insertBefore(t[r],n)}function ce(e,t,n,r){if(n===void 0)return e.textContent="";const s=r||document.createTextNode("");if(t.length){let o=!1;for(let i=t.length-1;i>=0;i--){const u=t[i];if(s!==u){const c=u.parentNode===e;!o&&!i?c?e.replaceChild(s,u):e.insertBefore(s,n):c&&u.remove()}else o=!0}}else e.insertBefore(s,n);return[s]}const kn="http://www.w3.org/2000/svg";function An(e,t=!1){return t?document.createElementNS(kn,e):document.createElement(e)}function En(e){const{useShadow:t}=e,n=document.createTextNode(""),r=()=>e.mount||document.body,s=ln();let o,i=!!on.context;return Q(()=>{o||(o=un(s,()=>q(()=>e.children)));const u=r();if(u instanceof HTMLHeadElement){const[c,h]=J(!1),d=()=>h(!0);gt(p=>X(u,()=>c()?p():o(),null)),pe(d)}else{const c=An(e.isSVG?"g":"div",e.isSVG),h=t&&c.attachShadow?c.attachShadow({mode:"open"}):c;Object.defineProperty(c,"_$host",{get(){return n.parentNode},configurable:!0}),X(h,o),u.appendChild(c),e.ref&&e.ref(c),pe(()=>u.removeChild(c))}},void 0,{render:!i}),n}var Ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ke(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dt={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ve,function(){var n=1e3,r=6e4,s=36e5,o="millisecond",i="second",u="minute",c="hour",h="day",d="week",p="month",v="quarter",$="year",S="date",y="Invalid Date",O=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var a=["th","st","nd","rd"],l=T%100;return"["+T+(a[(l-20)%10]||a[l]||a[0])+"]"}},_=function(T,a,l){var f=String(T);return!f||f.length>=a?T:""+Array(a+1-f.length).join(l)+T},j={s:_,z:function(T){var a=-T.utcOffset(),l=Math.abs(a),f=Math.floor(l/60),g=l%60;return(a<=0?"+":"-")+_(f,2,"0")+":"+_(g,2,"0")},m:function T(a,l){if(a.date()<l.date())return-T(l,a);var f=12*(l.year()-a.year())+(l.month()-a.month()),g=a.clone().add(f,p),b=l-g<0,m=a.clone().add(f+(b?-1:1),p);return+(-(f+(l-g)/(b?g-m:m-g))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:p,y:$,w:d,d:h,D:S,h:c,m:u,s:i,ms:o,Q:v}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},M="en",L={};L[M]=E;var F=function(T){return T instanceof V},z=function T(a,l,f){var g;if(!a)return M;if(typeof a=="string"){var b=a.toLowerCase();L[b]&&(g=b),l&&(L[b]=l,g=b);var m=a.split("-");if(!g&&m.length>1)return T(m[0])}else{var w=a.name;L[w]=a,g=w}return!f&&g&&(M=g),g||!f&&M},k=function(T,a){if(F(T))return T.clone();var l=typeof a=="object"?a:{};return l.date=T,l.args=arguments,new V(l)},D=j;D.l=z,D.i=F,D.w=function(T,a){return k(T,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var V=function(){function T(l){this.$L=z(l.locale,null,!0),this.parse(l)}var a=T.prototype;return a.parse=function(l){this.$d=function(f){var g=f.date,b=f.utc;if(g===null)return new Date(NaN);if(D.u(g))return new Date;if(g instanceof Date)return new Date(g);if(typeof g=="string"&&!/Z$/i.test(g)){var m=g.match(O);if(m){var w=m[2]-1||0,x=(m[7]||"0").substring(0,3);return b?new Date(Date.UTC(m[1],w,m[3]||1,m[4]||0,m[5]||0,m[6]||0,x)):new Date(m[1],w,m[3]||1,m[4]||0,m[5]||0,m[6]||0,x)}}return new Date(g)}(l),this.$x=l.x||{},this.init()},a.init=function(){var l=this.$d;this.$y=l.getFullYear(),this.$M=l.getMonth(),this.$D=l.getDate(),this.$W=l.getDay(),this.$H=l.getHours(),this.$m=l.getMinutes(),this.$s=l.getSeconds(),this.$ms=l.getMilliseconds()},a.$utils=function(){return D},a.isValid=function(){return this.$d.toString()!==y},a.isSame=function(l,f){var g=k(l);return this.startOf(f)<=g&&g<=this.endOf(f)},a.isAfter=function(l,f){return k(l)<this.startOf(f)},a.isBefore=function(l,f){return this.endOf(f)<k(l)},a.$g=function(l,f,g){return D.u(l)?this[f]:this.set(g,l)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(l,f){var g=this,b=!!D.u(f)||f,m=D.p(l),w=function(le,W){var re=D.w(g.$u?Date.UTC(g.$y,W,le):new Date(g.$y,W,le),g);return b?re:re.endOf(h)},x=function(le,W){return D.w(g.toDate()[le].apply(g.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(W)),g)},A=this.$W,P=this.$M,B=this.$D,te="set"+(this.$u?"UTC":"");switch(m){case $:return b?w(1,0):w(31,11);case p:return b?w(1,P):w(0,P+1);case d:var ae=this.$locale().weekStart||0,Te=(A<ae?A+7:A)-ae;return w(b?B-Te:B+(6-Te),P);case h:case S:return x(te+"Hours",0);case c:return x(te+"Minutes",1);case u:return x(te+"Seconds",2);case i:return x(te+"Milliseconds",3);default:return this.clone()}},a.endOf=function(l){return this.startOf(l,!1)},a.$set=function(l,f){var g,b=D.p(l),m="set"+(this.$u?"UTC":""),w=(g={},g[h]=m+"Date",g[S]=m+"Date",g[p]=m+"Month",g[$]=m+"FullYear",g[c]=m+"Hours",g[u]=m+"Minutes",g[i]=m+"Seconds",g[o]=m+"Milliseconds",g)[b],x=b===h?this.$D+(f-this.$W):f;if(b===p||b===$){var A=this.clone().set(S,1);A.$d[w](x),A.init(),this.$d=A.set(S,Math.min(this.$D,A.daysInMonth())).$d}else w&&this.$d[w](x);return this.init(),this},a.set=function(l,f){return this.clone().$set(l,f)},a.get=function(l){return this[D.p(l)]()},a.add=function(l,f){var g,b=this;l=Number(l);var m=D.p(f),w=function(P){var B=k(b);return D.w(B.date(B.date()+Math.round(P*l)),b)};if(m===p)return this.set(p,this.$M+l);if(m===$)return this.set($,this.$y+l);if(m===h)return w(1);if(m===d)return w(7);var x=(g={},g[u]=r,g[c]=s,g[i]=n,g)[m]||1,A=this.$d.getTime()+l*x;return D.w(A,this)},a.subtract=function(l,f){return this.add(-1*l,f)},a.format=function(l){var f=this,g=this.$locale();if(!this.isValid())return g.invalidDate||y;var b=l||"YYYY-MM-DDTHH:mm:ssZ",m=D.z(this),w=this.$H,x=this.$m,A=this.$M,P=g.weekdays,B=g.months,te=g.meridiem,ae=function(W,re,Se,Ye){return W&&(W[re]||W(f,b))||Se[re].slice(0,Ye)},Te=function(W){return D.s(w%12||12,W,"0")},le=te||function(W,re,Se){var Ye=W<12?"AM":"PM";return Se?Ye.toLowerCase():Ye};return b.replace(N,function(W,re){return re||function(Se){switch(Se){case"YY":return String(f.$y).slice(-2);case"YYYY":return D.s(f.$y,4,"0");case"M":return A+1;case"MM":return D.s(A+1,2,"0");case"MMM":return ae(g.monthsShort,A,B,3);case"MMMM":return ae(B,A);case"D":return f.$D;case"DD":return D.s(f.$D,2,"0");case"d":return String(f.$W);case"dd":return ae(g.weekdaysMin,f.$W,P,2);case"ddd":return ae(g.weekdaysShort,f.$W,P,3);case"dddd":return P[f.$W];case"H":return String(w);case"HH":return D.s(w,2,"0");case"h":return Te(1);case"hh":return Te(2);case"a":return le(w,x,!0);case"A":return le(w,x,!1);case"m":return String(x);case"mm":return D.s(x,2,"0");case"s":return String(f.$s);case"ss":return D.s(f.$s,2,"0");case"SSS":return D.s(f.$ms,3,"0");case"Z":return m}return null}(W)||m.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(l,f,g){var b,m=this,w=D.p(f),x=k(l),A=(x.utcOffset()-this.utcOffset())*r,P=this-x,B=function(){return D.m(m,x)};switch(w){case $:b=B()/12;break;case p:b=B();break;case v:b=B()/3;break;case d:b=(P-A)/6048e5;break;case h:b=(P-A)/864e5;break;case c:b=P/s;break;case u:b=P/r;break;case i:b=P/n;break;default:b=P}return g?b:D.a(b)},a.daysInMonth=function(){return this.endOf(p).$D},a.$locale=function(){return L[this.$L]},a.locale=function(l,f){if(!l)return this.$L;var g=this.clone(),b=z(l,f,!0);return b&&(g.$L=b),g},a.clone=function(){return D.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},T}(),ut=V.prototype;return k.prototype=ut,[["$ms",o],["$s",i],["$m",u],["$H",c],["$W",h],["$M",p],["$y",$],["$D",S]].forEach(function(T){ut[T[1]]=function(a){return this.$g(a,T[0],T[1])}}),k.extend=function(T,a){return T.$i||(T(a,V,k),T.$i=!0),k},k.locale=z,k.isDayjs=F,k.unix=function(T){return k(1e3*T)},k.en=L[M],k.Ls=L,k.p={},k})})(Dt);var _n=Dt.exports;const Ge=Ke(_n);var Mt={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ve,function(){var n={year:0,month:1,day:2,hour:3,minute:4,second:5},r={};return function(s,o,i){var u,c=function(v,$,S){S===void 0&&(S={});var y=new Date(v),O=function(N,E){E===void 0&&(E={});var _=E.timeZoneName||"short",j=N+"|"+_,M=r[j];return M||(M=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:N,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:_}),r[j]=M),M}($,S);return O.formatToParts(y)},h=function(v,$){for(var S=c(v,$),y=[],O=0;O<S.length;O+=1){var N=S[O],E=N.type,_=N.value,j=n[E];j>=0&&(y[j]=parseInt(_,10))}var M=y[3],L=M===24?0:M,F=y[0]+"-"+y[1]+"-"+y[2]+" "+L+":"+y[4]+":"+y[5]+":000",z=+v;return(i.utc(F).valueOf()-(z-=z%1e3))/6e4},d=o.prototype;d.tz=function(v,$){v===void 0&&(v=u);var S=this.utcOffset(),y=this.toDate(),O=y.toLocaleString("en-US",{timeZone:v}),N=Math.round((y-new Date(O))/1e3/60),E=i(O).$set("millisecond",this.$ms).utcOffset(15*-Math.round(y.getTimezoneOffset()/15)-N,!0);if($){var _=E.utcOffset();E=E.add(S-_,"minute")}return E.$x.$timezone=v,E},d.offsetName=function(v){var $=this.$x.$timezone||i.tz.guess(),S=c(this.valueOf(),$,{timeZoneName:v}).find(function(y){return y.type.toLowerCase()==="timezonename"});return S&&S.value};var p=d.startOf;d.startOf=function(v,$){if(!this.$x||!this.$x.$timezone)return p.call(this,v,$);var S=i(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return p.call(S,v,$).tz(this.$x.$timezone,!0)},i.tz=function(v,$,S){var y=S&&$,O=S||$||u,N=h(+i(),O);if(typeof v!="string")return i(v).tz(O);var E=function(L,F,z){var k=L-60*F*1e3,D=h(k,z);if(F===D)return[k,F];var V=h(k-=60*(D-F)*1e3,z);return D===V?[k,D]:[L-60*Math.min(D,V)*1e3,Math.max(D,V)]}(i.utc(v,y).valueOf(),N,O),_=E[0],j=E[1],M=i(_).utcOffset(j);return M.$x.$timezone=O,M},i.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},i.tz.setDefault=function(v){u=v}}})})(Mt);var Cn=Mt.exports;const In=Ke(Cn);var kt={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ve,function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(o,i,u){var c=i.prototype;u.utc=function(y){var O={date:y,utc:!0,args:arguments};return new i(O)},c.utc=function(y){var O=u(this.toDate(),{locale:this.$L,utc:!0});return y?O.add(this.utcOffset(),n):O},c.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var h=c.parse;c.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),h.call(this,y)};var d=c.init;c.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else d.call(this)};var p=c.utcOffset;c.utcOffset=function(y,O){var N=this.$utils().u;if(N(y))return this.$u?0:N(this.$offset)?p.call(this):this.$offset;if(typeof y=="string"&&(y=function(M){M===void 0&&(M="");var L=M.match(r);if(!L)return null;var F=(""+L[0]).match(s)||["-",0,0],z=F[0],k=60*+F[1]+ +F[2];return k===0?0:z==="+"?k:-k}(y),y===null))return this;var E=Math.abs(y)<=16?60*y:y,_=this;if(O)return _.$offset=E,_.$u=y===0,_;if(y!==0){var j=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(_=this.local().add(E+j,n)).$offset=E,_.$x.$localOffset=j}else _=this.utc();return _};var v=c.format;c.format=function(y){var O=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return v.call(this,O)},c.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var $=c.toDate;c.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():$.call(this)};var S=c.diff;c.diff=function(y,O,N){if(y&&this.$u===y.$u)return S.call(this,y,O,N);var E=this.local(),_=u(y).local();return S.call(E,_,O,N)}}})})(kt);var Ln=kt.exports;const Pn=Ke(Ln);Ge.extend(Pn),Ge.extend(In);const At={offset:180,region:"Asia",location:"Kuwait"};function Xe(){return Ge.tz(new Date,`${At.region}/${At.location}`).format("DD.MM.YYYY")}function Nn(e){return Object.entries(e)}function Et(e){return e=Math.abs(e),e>9?`${e}`:`0${e}`}const _t={info:"#2ecc71",debug:"#7f8c8d",warn:"#f39c12",error:"#c0392b"};function jn(e){return[`background: ${_t[e]}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em","font-family: cursive"].join(";")}const K=Object.freeze(Nn(_t).reduce((e,[t])=>(e[t]=(...n)=>{console[t]("%ctryrating-userscript",jn(t),...n)},e),{})),Ze=()=>[{date:Xe(),total:0,list:[]}],[ye,Je]=J([]);class Rn{STORAGE_KEY="tryrating-storage-v2";constructor(){this.read()}get taskList(){return ye()}read(){const t=GM_getValue(this.STORAGE_KEY,Ze());K.info("Readed tasks",t),Je(t)}reset(){Je(Ze()),GM_setValue(this.STORAGE_KEY,ye())}write(t){const n=this.getTaskList();n.total+=1;const r=n.list.find(o=>o.type===t.type);r?(r.count+=1,r.estimated+=t.estimated):n.list.push({count:1,type:t.type,estimated:t.estimated});const s=[n,...ye().filter(o=>o.date!==n.date)];Je(s),GM_setValue(this.STORAGE_KEY,ye())}getTaskList(){const t=Xe();K.info("Current date",t);const n=ye().find(r=>r.date===t);return K.info("Task list",n),n||Ze()[0]}}const Ce=new Rn;function Y(e,t,...n){const r=document.createElement(e);return t instanceof Node?r.append(t):typeof t=="string"?r.append(Fn(t)):Array.isArray(t)?r.append(...t):(Object.assign(r,t),Object.assign(r.style,t?.style)),r.append(...n),r}function Fn(e){return document.createTextNode(e)}function Qe(e,t,n){const r=new MutationObserver((s,o)=>{for(const i of s)t(i,o)});return r.observe(e,{childList:!0,subtree:!0,...n}),()=>r.disconnect()}function Yn(e,t=document.body){return new Promise(n=>{Qe(t,(r,s)=>{const o=t.querySelector(e);o&&(s.disconnect(),n(o))})})}const fe=1e3,de=fe*60,ge=de*60,ie=ge*24,Un=ie*7,zn=ie*365.25;function et(e,t){try{if(typeof e=="string"&&e.length>0)return Bn(e);if(typeof e=="number"&&isFinite(e))return t?.long?Hn(e):Wn(e);throw new Error("Value is not a string or number.")}catch(n){const r=qn(n)?`${n.message}. value=${JSON.stringify(e)}`:"An unknown error has occured.";throw new Error(r)}}function Bn(e){if(e=String(e),e.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");const t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return NaN;const n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*zn;case"weeks":case"week":case"w":return n*Un;case"days":case"day":case"d":return n*ie;case"hours":case"hour":case"hrs":case"hr":case"h":return n*ge;case"minutes":case"minute":case"mins":case"min":case"m":return n*de;case"seconds":case"second":case"secs":case"sec":case"s":return n*fe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:throw new Error(`The unit ${r} was matched, but no matching case exists.`)}}function Wn(e){const t=Math.abs(e);return t>=ie?`${Math.round(e/ie)}d`:t>=ge?`${Math.round(e/ge)}h`:t>=de?`${Math.round(e/de)}m`:t>=fe?`${Math.round(e/fe)}s`:`${e}ms`}function Hn(e){const t=Math.abs(e);return t>=ie?Ie(e,t,ie,"day"):t>=ge?Ie(e,t,ge,"hour"):t>=de?Ie(e,t,de,"minute"):t>=fe?Ie(e,t,fe,"second"):`${e} ms`}function Ie(e,t,n,r){const s=t>=n*1.5;return`${Math.round(e/n)} ${r}${s?"s":""}`}function qn(e){return typeof e=="object"&&e!==null&&"message"in e}const Vn=ue("<button>Tasks: ");class Kn{open(){const t=Ce.taskList;if(!t.length){alert("\u041D\u0435\u0442\u0443 \u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430.");return}const n=Y("div");for(const{date:o,list:i,total:u}of t){let c=0;const h=Y("table",{border:"1"}),d=Y("div",{style:{display:"flex",gap:"4px",flexDirection:"column"}}),p=Y("tr",Y("th","Task Type"),Y("th","Count"),Y("th","Estimated Rating Time"));h.append(d,p);for(const{count:v,estimated:$,type:S}of i){c+=$;const y=Y("tr",Y("td",S),Y("td",`${v}`),Y("td",et($,{long:!0})));h.append(y)}d.append(Y("span",`Date: ${o}`),Y("span",`Tasks ${u}`),Y("span",`Estimated time: ${et(c,{long:!0})}`)),n.append(Y("div",h,Y("hr")))}const r=new Blob([n.outerHTML],{type:"text/html"});Y("a",{target:"_blank",href:URL.createObjectURL(r)}).click()}}const Ct=new Kn,Gn=()=>{const e=q(()=>{const t=Xe();return Ce.taskList.find(r=>r.date===t)?.total??"0"});return(()=>{const t=Vn();return t.firstChild,t.$$click=()=>Ct.open(),t.style.setProperty("background","gray"),X(t,e,null),t})()};St(["click"]);const Xn=ue("<button>Autosubmit"),[Le,Zn]=J(!0);function It(){Zn(!Le())}function tt(){return{get autosubmit(){return Le()},toggleAutosubmit:It}}const Jn=()=>(()=>{const e=Xn();return e.$$click=()=>It(),se(()=>(Le()?"#4CAF50":"#f44336")!=null?e.style.setProperty("background",Le()?"#4CAF50":"#f44336"):e.style.removeProperty("background")),e})();St(["click"]);const nt=Symbol("store-raw"),be=Symbol("store-node");function Lt(e){let t=e[G];if(!t&&(Object.defineProperty(e,G,{value:t=new Proxy(e,tr)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let s=0,o=n.length;s<o;s++){const i=n[s];r[i].get&&Object.defineProperty(e,i,{enumerable:r[i].enumerable,get:r[i].get.bind(t)})}}return t}function Pe(e){let t;return e!=null&&typeof e=="object"&&(e[G]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ve(e,t=new Set){let n,r,s,o;if(n=e!=null&&e[nt])return n;if(!Pe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,u=e.length;i<u;i++)s=e[i],(r=ve(s,t))!==s&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),u=Object.getOwnPropertyDescriptors(e);for(let c=0,h=i.length;c<h;c++)o=i[c],!u[o].get&&(s=e[o],(r=ve(s,t))!==s&&(e[o]=r))}return e}function rt(e){let t=e[be];return t||Object.defineProperty(e,be,{value:t=Object.create(null)}),t}function st(e,t,n){return e[t]||(e[t]=Nt(n))}function Qn(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===G||t===be||(delete n.value,delete n.writable,n.get=()=>e[G][t]),n}function Pt(e){if(pt()){const t=rt(e);(t._||(t._=Nt()))()}}function er(e){return Pt(e),Reflect.ownKeys(e)}function Nt(e){const[t,n]=J(e,{equals:!1,internal:!0});return t.$=n,t}const tr={get(e,t,n){if(t===nt)return e;if(t===G)return n;if(t===ct)return Pt(e),n;const r=rt(e),s=r[t];let o=s?s():e[t];if(t===be||t==="__proto__")return o;if(!s){const i=Object.getOwnPropertyDescriptor(e,t);pt()&&(typeof o!="function"||e.hasOwnProperty(t))&&!(i&&i.get)&&(o=st(r,t,o)())}return Pe(o)?Lt(o):o},has(e,t){return t===nt||t===G||t===ct||t===be||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:er,getOwnPropertyDescriptor:Qn};function Ne(e,t,n,r=!1){if(!r&&e[t]===n)return;const s=e[t],o=e.length;n===void 0?delete e[t]:e[t]=n;let i=rt(e),u;if((u=st(i,t,s))&&u.$(()=>n),Array.isArray(e)&&e.length!==o){for(let c=e.length;c<o;c++)(u=i[c])&&u.$();(u=st(i,"length",o))&&u.$(e.length)}(u=i._)&&u.$()}function jt(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const s=n[r];Ne(e,s,t[s])}}function nr(e,t){if(typeof t=="function"&&(t=t(e)),t=ve(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const s=t[n];e[n]!==s&&Ne(e,n,s)}Ne(e,"length",r)}else jt(e,t)}function we(e,t,n=[]){let r,s=e;if(t.length>1){r=t.shift();const i=typeof r,u=Array.isArray(e);if(Array.isArray(r)){for(let c=0;c<r.length;c++)we(e,[r[c]].concat(t),n);return}else if(u&&i==="function"){for(let c=0;c<e.length;c++)r(e[c],c)&&we(e,[c].concat(t),n);return}else if(u&&i==="object"){const{from:c=0,to:h=e.length-1,by:d=1}=r;for(let p=c;p<=h;p+=d)we(e,[p].concat(t),n);return}else if(t.length>1){we(e[r],t,[r].concat(n));return}s=e[r],n=[r].concat(n)}let o=t[0];typeof o=="function"&&(o=o(s,n),o===s)||r===void 0&&o==null||(o=ve(o),r===void 0||Pe(s)&&Pe(o)&&!Array.isArray(o)?jt(s,o):Ne(e,r,o))}function Rt(...[e,t]){const n=ve(e||{}),r=Array.isArray(n),s=Lt(n);function o(...i){ee(()=>{r&&i.length===1?nr(n,i[0]):we(n,i)})}return[s,o]}const rr=ue("<div>");var je=class{x;y;width;height;constructor(e){this.x=Math.floor(e.x),this.y=Math.floor(e.y),this.width=Math.floor(e.width),this.height=Math.floor(e.height)}get rect(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get center(){return{x:this.x+this.width*.5,y:this.y+this.height*.5}}get corners(){return{topLeft:{x:this.left,y:this.top},topRight:{x:this.right,y:this.top},bottomRight:{x:this.left,y:this.bottom},bottomLeft:{x:this.right,y:this.bottom}}}},$e=e=>{let t=new je(e.getBoundingClientRect());const{transform:n}=getComputedStyle(e);return n&&(t=sr(t,n)),t},sr=(e,t)=>{let n,r;if(t.startsWith("matrix3d(")){const s=t.slice(9,-1).split(/, /);n=+s[12],r=+s[13]}else if(t.startsWith("matrix(")){const s=t.slice(7,-1).split(/, /);n=+s[4],r=+s[5]}else n=0,r=0;return new je({...e,x:e.x-n,y:e.y-r})},he=()=>({x:0,y:0}),or=(e,t)=>e.x===t.x&&e.y===t.y,ot=(e,t)=>new je({...e,x:e.x+t.x,y:e.y+t.y}),ir=(e,t)=>{const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),s=Math.min(e.right,t.right),o=Math.min(e.bottom,t.bottom),i=s-r,u=o-n;if(r<s&&n<o){const c=e.width*e.height,h=t.width*t.height,d=i*u;return d/(c+h-d)}return 0},it=(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,ar=(e,t,n)=>{const r=e.transformed,s={ratio:0,droppable:null};for(const o of t){const i=ir(r,o.layout);i>s.ratio?(s.ratio=i,s.droppable=o):i>0&&i===s.ratio&&o.id===n.activeDroppableId&&(s.droppable=o)}return s.droppable},Ft=cn(),lr=e=>{const t=wn({collisionDetector:ar},e),[n,r]=Rt({draggables:{},droppables:{},sensors:{},active:{draggableId:null,get draggable(){return n.active.draggableId!==null?n.draggables[n.active.draggableId]:null},droppableId:null,get droppable(){return n.active.droppableId!==null?n.droppables[n.active.droppableId]:null},sensorId:null,get sensor(){return n.active.sensorId!==null?n.sensors[n.active.sensorId]:null},overlay:null}}),s=(a,l,f)=>{a.substring(0,a.length-1),R(()=>n[a][l])&&r(a,l,"transformers",f.id,f)},o=(a,l,f)=>{a.substring(0,a.length-1),R(()=>n[a][l])&&R(()=>n[a][l].transformers[f])&&r(a,l,"transformers",f,void 0)},i=({id:a,node:l,layout:f,data:g})=>{const b=n.draggables[a],m={id:a,node:l,layout:f,data:g,_pendingCleanup:!1};let w;if(!b)Object.defineProperties(m,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{if(n.active.overlay)return he();const x=Object.values(n.draggables[a].transformers);return x.sort((A,P)=>A.order-P.order),x.reduce((A,P)=>P.callback(A),he())}},transformed:{enumerable:!0,configurable:!0,get:()=>ot(n.draggables[a].layout,n.draggables[a].transform)}});else if(n.active.draggableId===a&&!n.active.overlay){const x={x:b.layout.x-f.x,y:b.layout.y-f.y},A="addDraggable-existing-offset",P=b.transformers[A],B=P?P.callback(x):x;w={id:A,order:100,callback:te=>({x:te.x+B.x,y:te.y+B.y})},V(()=>o("draggables",a,A))}ee(()=>{r("draggables",a,m),w&&s("draggables",a,w)}),n.active.draggable&&j()},u=a=>{R(()=>n.draggables[a])&&(r("draggables",a,"_pendingCleanup",!0),queueMicrotask(()=>c(a)))},c=a=>{if(n.draggables[a]?._pendingCleanup){const l=n.active.draggableId===a;ee(()=>{l&&r("active","draggableId",null),r("draggables",a,void 0)})}},h=({id:a,node:l,layout:f,data:g})=>{const b=n.droppables[a],m={id:a,node:l,layout:f,data:g,_pendingCleanup:!1};b||Object.defineProperties(m,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{const w=Object.values(n.droppables[a].transformers);return w.sort((x,A)=>x.order-A.order),w.reduce((x,A)=>A.callback(x),he())}},transformed:{enumerable:!0,configurable:!0,get:()=>ot(n.droppables[a].layout,n.droppables[a].transform)}}),r("droppables",a,m),n.active.draggable&&j()},d=a=>{R(()=>n.droppables[a])&&(r("droppables",a,"_pendingCleanup",!0),queueMicrotask(()=>p(a)))},p=a=>{if(n.droppables[a]?._pendingCleanup){const l=n.active.droppableId===a;ee(()=>{l&&r("active","droppableId",null),r("droppables",a,void 0)})}},v=({id:a,activators:l})=>{r("sensors",a,{id:a,activators:l,coordinates:{origin:{x:0,y:0},current:{x:0,y:0},get delta(){return{x:n.sensors[a].coordinates.current.x-n.sensors[a].coordinates.origin.x,y:n.sensors[a].coordinates.current.y-n.sensors[a].coordinates.origin.y}}}})},$=a=>{if(!R(()=>n.sensors[a]))return;const l=n.active.sensorId===a;ee(()=>{l&&r("active","sensorId",null),r("sensors",a,void 0)})},S=({node:a,layout:l})=>{const f=n.active.overlay,g={node:a,layout:l};f||Object.defineProperties(g,{id:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.id},data:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.data},transformers:{enumerable:!0,configurable:!0,get:()=>Object.fromEntries(Object.entries(n.active.draggable?n.active.draggable.transformers:{}).filter(([b])=>b!=="addDraggable-existing-offset"))},transform:{enumerable:!0,configurable:!0,get:()=>{const b=Object.values(n.active.overlay?n.active.overlay.transformers:[]);return b.sort((m,w)=>m.order-w.order),b.reduce((m,w)=>w.callback(m),he())}},transformed:{enumerable:!0,configurable:!0,get:()=>n.active.overlay?ot(n.active.overlay.layout,n.active.overlay.transform):new je({x:0,y:0,width:0,height:0})}}),r("active","overlay",g)},y=()=>r("active","overlay",null),O=(a,l)=>{ee(()=>{r("sensors",a,"coordinates",{origin:{...l},current:{...l}}),r("active","sensorId",a)})},N=a=>{const l=n.active.sensorId;l&&r("sensors",l,"coordinates","current",{...a})},E=()=>r("active","sensorId",null),_=(a,l)=>{const f={};for(const b of Object.values(n.sensors))if(b)for(const[m,w]of Object.entries(b.activators))f[m]??=[],f[m].push({sensor:b,activator:w});const g={};for(const b in f){let m=b;l&&(m=`on${b}`),g[m]=w=>{for(const{activator:x}of f[b]){if(n.active.sensor)break;x(w,a)}}}return g},j=()=>{let a=!1;const l=Object.values(n.draggables),f=Object.values(n.droppables),g=n.active.overlay;return ee(()=>{const b=new WeakMap;for(const m of l)if(m){const w=m.layout;b.has(m.node)||b.set(m.node,$e(m.node));const x=b.get(m.node);it(w,x)||(r("draggables",m.id,"layout",x),a=!0)}for(const m of f)if(m){const w=m.layout;b.has(m.node)||b.set(m.node,$e(m.node));const x=b.get(m.node);it(w,x)||(r("droppables",m.id,"layout",x),a=!0)}if(g){const m=g.layout,w=$e(g.node);it(m,w)||(r("active","overlay","layout",w),a=!0)}}),a},M=()=>{const a=n.active.overlay??n.active.draggable;if(a){const l=t.collisionDetector(a,Object.values(n.droppables),{activeDroppableId:n.active.droppableId}),f=l?l.id:null;n.active.droppableId!==f&&r("active","droppableId",f)}},L=a=>{const l={id:"sensorMove",order:0,callback:f=>n.active.sensor?{x:f.x+n.active.sensor.coordinates.delta.x,y:f.y+n.active.sensor.coordinates.delta.y}:f};j(),ee(()=>{r("active","draggableId",a),s("draggables",a,l)}),M()},F=()=>{const a=R(()=>n.active.draggableId);ee(()=>{a!==null&&o("draggables",a,"sensorMove"),r("active",["draggableId","droppableId"],null)}),j()},z=a=>{Q(()=>{const l=n.active.draggable;l&&R(()=>a({draggable:l}))})},k=a=>{Q(()=>{const l=n.active.draggable;if(l){const f=R(()=>n.active.overlay);Object.values(f?f.transform:l.transform),R(()=>a({draggable:l,overlay:f}))}})},D=a=>{Q(()=>{const l=n.active.draggable,f=n.active.droppable;l&&R(()=>a({draggable:l,droppable:f,overlay:n.active.overlay}))})},V=a=>{Q(({previousDraggable:l,previousDroppable:f,previousOverlay:g})=>{const b=n.active.draggable,m=b?n.active.droppable:null,w=b?n.active.overlay:null;return!b&&l&&R(()=>a({draggable:l,droppable:f,overlay:g})),{previousDraggable:b,previousDroppable:m,previousOverlay:w}},{previousDraggable:null,previousDroppable:null,previousOverlay:null})};k(()=>M()),t.onDragStart&&z(t.onDragStart),t.onDragMove&&k(t.onDragMove),t.onDragOver&&D(t.onDragOver),t.onDragEnd&&V(t.onDragEnd);const T=[n,{addTransformer:s,removeTransformer:o,addDraggable:i,removeDraggable:u,addDroppable:h,removeDroppable:d,addSensor:v,removeSensor:$,setOverlay:S,clearOverlay:y,recomputeLayouts:j,detectCollisions:M,draggableActivators:_,sensorStart:O,sensorMove:N,sensorEnd:E,dragStart:L,dragEnd:F,onDragStart:z,onDragMove:k,onDragOver:D,onDragEnd:V}];return H(Ft.Provider,{value:T,get children(){return t.children}})},at=()=>fn(Ft)||null,ur=(e="pointer-sensor")=>{const[t,{addSensor:n,removeSensor:r,sensorStart:s,sensorMove:o,sensorEnd:i,dragStart:u,dragEnd:c}]=at(),h=250,d=10;ht(()=>{n({id:e,activators:{pointerdown:y}})}),pe(()=>{r(e)});const p=()=>t.active.sensorId===e,v={x:0,y:0};let $=null,S=null;const y=(M,L)=>{M.button===0&&(document.addEventListener("pointermove",E),document.addEventListener("pointerup",_),S=L,v.x=M.clientX,v.y=M.clientY,$=window.setTimeout(N,h))},O=()=>{$&&(clearTimeout($),$=null),document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",_),document.removeEventListener("selectionchange",j)},N=()=>{t.active.sensor?p()||O():(s(e,v),u(S),j(),document.addEventListener("selectionchange",j))},E=M=>{const L={x:M.clientX,y:M.clientY};if(!t.active.sensor){const F={x:L.x-v.x,y:L.y-v.y};Math.sqrt(F.x**2+F.y**2)>d&&N()}p()&&(M.preventDefault(),o(L))},_=M=>{O(),p()&&(M.preventDefault(),c(),i())},j=()=>{window.getSelection()?.removeAllRanges()}},cr=e=>(ur(),q(()=>e.children)),Yt=e=>({transform:`translate3d(${e.x}px, ${e.y}px, 0)`}),fr=(e,t={})=>{const[n,{addDraggable:r,removeDraggable:s,draggableActivators:o}]=at(),[i,u]=J(null);ht(()=>{const p=i();p&&r({id:e,node:p,layout:$e(p),data:t})}),pe(()=>s(e));const c=()=>n.active.draggableId===e,h=()=>n.draggables[e]?.transform||he();return Object.defineProperties((p,v)=>{const $=v?v():{};Q(()=>{const S=i(),y=o(e);if(S)for(const O in y)S.addEventListener(O,y[O]);pe(()=>{if(S)for(const O in y)S.removeEventListener(O,y[O])})}),u(p),$.skipTransform||Q(()=>{const S=h();if(or(S,he()))p.style.removeProperty("transform");else{const y=Yt(h());p.style.setProperty("transform",y.transform??null)}})},{ref:{enumerable:!0,value:u},isActiveDraggable:{enumerable:!0,get:c},dragActivators:{enumerable:!0,get:()=>o(e,!0)},transform:{enumerable:!0,get:h}})},dr=e=>{const[t,{onDragStart:n,onDragEnd:r,setOverlay:s,clearOverlay:o}]=at();let i;n(({draggable:c})=>{s({node:c.node,layout:c.layout}),queueMicrotask(()=>{if(i){const h=$e(i),d={x:(c.layout.width-h.width)/2,y:(c.layout.height-h.height)/2};h.x+=d.x,h.y+=d.y,s({node:i,layout:h})}})}),r(()=>queueMicrotask(o));const u=()=>{const c=t.active.overlay,h=t.active.draggable;return!c||!h?{}:{position:"fixed",transition:"transform 0s",top:`${c.layout.top}px`,left:`${c.layout.left}px`,"min-width":`${h.layout.width}px`,"min-height":`${h.layout.height}px`,...Yt(c.transform),...e.style}};return H(En,{get mount(){return document.body},get children(){return H($t,{get when(){return t.active.draggable},get children(){const c=rr(),h=i;return typeof h=="function"?xt(h,c):i=c,X(c,(()=>{const d=q(()=>typeof e.children=="function");return()=>d()?e.children(t.active.draggable):e.children})()),se(d=>{const p=e.class,v=u();return p!==d._v$&&On(c,d._v$=p),d._v$2=Dn(c,v,d._v$2),d},{_v$:void 0,_v$2:void 0}),c}})}})};function gr(e,t){const n=localStorage.getItem(e),[r,s]=Rt(n?JSON.parse(n):t);return Q(()=>localStorage.setItem(e,JSON.stringify(r))),[r,s]}const hr=ue('<div class="widget-draggable widget-absolute">'),pr=ue('<div class="widget-drag-overlay"><span class="widget-drag-text">alt+3 reset position'),[Ut,zt]=gr("widget-position",{top:"0px",left:"0px"});function mr(){zt({top:"0px",left:"0px"})}const yr=e=>{const t=fr(e.id);return(()=>{const n=hr();return xt(t,n,()=>!0),X(n,()=>e.children),se(r=>{const s=!!t.isActiveDraggable,o=Ut.top,i=Ut.left;return s!==r._v$&&n.classList.toggle("widget-opacity-25",r._v$=s),o!==r._v$2&&((r._v$2=o)!=null?n.style.setProperty("top",o):n.style.removeProperty("top")),i!==r._v$3&&((r._v$3=i)!=null?n.style.setProperty("left",i):n.style.removeProperty("left")),r},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()},br=e=>{let t={x:0,y:0};return H(lr,{onDragMove:({overlay:s})=>{s&&(t={...s.transform})},onDragEnd:({draggable:s})=>{const o=s.node,i=`${o.offsetTop+t.y}px`,u=`${o.offsetLeft+t.x}px`;zt({top:i,left:u})},get children(){return[H(cr,{}),H(yr,{id:1,get children(){return e.children}}),H(dr,{get children(){return[pr(),q(()=>e.children)]}})]}})},[Bt,vr]=J(!0);function wr(){vr(!Bt())}const $r=e=>H($t,{get when(){return Bt()},get children(){return e.children}}),{toggleAutosubmit:Tr}=tt();function Sr(){window.addEventListener("keydown",e=>{e.altKey&&e.key==="1"&&(e.preventDefault(),Ct.open()),e.altKey&&e.key==="2"&&(e.preventDefault(),confirm(`Reset data.
Are you sure?`)&&Ce.reset()),e.altKey&&e.key==="3"&&(e.preventDefault(),mr()),e.ctrlKey&&e.code==="KeyO"&&(e.preventDefault(),Tr()),e.ctrlKey&&e.code==="KeyX"&&(e.preventDefault(),wr())})}const xr=".modal-container.visible",Or="div[modalwrapref] > div",Wt="Validation failed!";function Dr(){const e=document.querySelector(xr);if(!e)return;const t=e.querySelector(Or);if(t&&t.textContent===Wt){GM_notification({title:document.title,text:Wt,highlight:!0,silent:!1,timeout:1e3});const n=e.querySelector("button");n&&(K.info("Modal closed"),n.click())}}function Ht(e){return e.split(/\s(?=\d)/).reduce((n,r)=>(n+=et(r),n),0)}const{autosubmit:Mr,toggleAutosubmit:kr}=tt();class Ar{taskFields=null;onChangeTaskCallback=null;get targetSelector(){return".survey-meta-fields"}onChangeTask(t){this.onChangeTaskCallback=t}observe(){const t=document.querySelector(this.targetSelector);if(!t){K.error("Task fields not found");return}const n=Array.from(t.querySelectorAll(".labeled-attribute__attribute"));if(!n.length){K.error("Task fields attributes not found");return}const[r,s,o]=n,i={taskType:r.textContent,requestId:s.textContent,estimatedRatingTime:o.textContent.trim()};i.requestId!==this.taskFields?.requestId&&(K.info("Task fields changed",i),this.onChangeTaskCallback(i),Mr||kr(),this.taskFields&&(K.info("Task is submitted",this.taskFields),Ce.write({type:this.taskFields.taskType,estimated:Ht(this.taskFields.estimatedRatingTime)})),this.taskFields=i)}}const Re=new Ar;async function Er(){const e=document.querySelector("#app-root");if(!e){K.error("App root not found");return}Qe(e,()=>Dr()),Yn(Re.targetSelector).then(t=>{Re.observe(),Qe(t,()=>Re.observe())}).finally(()=>K.info("Initialized task fields observer"))}const _r=e=>(t,n)=>(e.set(t,n),n),qt=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Vt=536870912,Kt=Vt*2,Cr=(e,t)=>n=>{const r=t.get(n);let s=r===void 0?n.size:r<Kt?r+1:0;if(!n.has(s))return e(n,s);if(n.size<Vt){for(;n.has(s);)s=Math.floor(Math.random()*Kt);return e(n,s)}if(n.size>qt)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(s);)s=Math.floor(Math.random()*qt);return e(n,s)},Gt=new WeakMap,Ir=_r(Gt),Fe=Cr(Ir,Gt),Lr=e=>e.method!==void 0&&e.method==="call",Pr=e=>e.error===null&&typeof e.id=="number",Xt=((e,t)=>{let n=null;return()=>{if(n!==null)return n;const r=new Blob([t],{type:"application/javascript; charset=utf-8"}),s=URL.createObjectURL(r);return n=e(s),setTimeout(()=>URL.revokeObjectURL(s)),n}})(e=>{const t=new Map([[0,()=>{}]]),n=new Map([[0,()=>{}]]),r=new Map,s=new Worker(e);return s.addEventListener("message",({data:h})=>{if(Lr(h)){const{params:{timerId:d,timerType:p}}=h;if(p==="interval"){const v=t.get(d);if(typeof v=="number"){const $=r.get(v);if($===void 0||$.timerId!==d||$.timerType!==p)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v();else throw new Error("The timer is in an undefined state.")}else if(p==="timeout"){const v=n.get(d);if(typeof v=="number"){const $=r.get(v);if($===void 0||$.timerId!==d||$.timerType!==p)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v(),n.delete(d);else throw new Error("The timer is in an undefined state.")}}else if(Pr(h)){const{id:d}=h,p=r.get(d);if(p===void 0)throw new Error("The timer is in an undefined state.");const{timerId:v,timerType:$}=p;r.delete(d),$==="interval"?t.delete(v):n.delete(v)}else{const{error:{message:d}}=h;throw new Error(d)}}),{clearInterval:h=>{const d=Fe(r);r.set(d,{timerId:h,timerType:"interval"}),t.set(h,d),s.postMessage({id:d,method:"clear",params:{timerId:h,timerType:"interval"}})},clearTimeout:h=>{const d=Fe(r);r.set(d,{timerId:h,timerType:"timeout"}),n.set(h,d),s.postMessage({id:d,method:"clear",params:{timerId:h,timerType:"timeout"}})},setInterval:(h,d)=>{const p=Fe(t);return t.set(p,()=>{h(),typeof t.get(p)=="function"&&s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:p,timerType:"interval"}})}),s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:p,timerType:"interval"}}),p},setTimeout:(h,d)=>{const p=Fe(n);return n.set(p,h),s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:p,timerType:"timeout"}}),p}}},`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`),Zt=e=>Xt().clearInterval(e),Jt=(e,t)=>Xt().setInterval(e,t),[Nr,Qt]=J(0);class jr{intervalId;get time(){return Nr()}tick(){Qt(t=>t+1e3)}start(){this.intervalId&&(Zt(this.intervalId),Qt(0)),this.intervalId=Jt(()=>this.tick(),1e3)}}const en=new jr,Rr=".btn-success",Fr="Submit Rating",[Yr,Ur]=J([]);function zr(){const e=[],t=Array.from(document.querySelectorAll(Rr));for(const n of t)n instanceof HTMLButtonElement&&n.textContent===Fr&&e.push(n);return Ur(e),e}function Br(){return{findSubmitButtons:zr,get submitButtons(){return Yr()}}}const[tn,nn]=J(0);class Wr{intervalId;onEndCallback;onTickTimer(){const t=tn()-1e3;nn(t),t===0&&(this.onEndCallback(),this.stop())}get time(){return tn()}onTimerEnd(t){this.onEndCallback=t}start(t){this.stop(),nn(t),this.intervalId=Jt(()=>this.onTickTimer(),1e3)}stop(){this.intervalId&&(Zt(this.intervalId),this.intervalId=null)}}const lt=new Wr;function rn(e){const t=Et(Math.floor(e/6e4)),n=Et(Number((e%6e4/1e3).toFixed(0)));return`${t}:${n}`}const Zr="",Hr=ue('<div class="tryrating-widget"><div>Timer: </div><div>Stopwatch: '),{autosubmit:qr}=tt(),{findSubmitButtons:sn}=Br();lt.onTimerEnd(()=>{if(!qr)return;const e=sn();if(!e.length){K.error("Submit button is not defined");return}e[0].click()}),Re.onChangeTask(e=>{sn();const t=Ht(e.estimatedRatingTime);lt.start(t),en.start()});const Vr=()=>{const e=q(()=>rn(lt.time)),t=q(()=>rn(en.time));return H($r,{get children(){return H(br,{get children(){const n=Hr(),r=n.firstChild;r.firstChild;const s=r.nextSibling;return s.firstChild,X(r,e,null),X(s,t,null),X(n,H(Gn,{}),null),X(n,H(Jn,{}),null),n}})}})};Er(),Sr(),Sn(()=>H(Vr,{}),document.body),GM_addStyle(":root{--try-font-family: monospace}.tryrating-widget{display:flex;color:#fff;padding-left:4px;background:#2e2c2f;font-size:1rem;font-weight:600;align-items:center;height:40px;justify-content:center;text-transform:uppercase;font-family:var(--try-font-family)}.tryrating-widget>div{padding:10px}.tryrating-widget>button{text-transform:inherit;height:inherit;border:none;font-size:inherit;font-weight:inherit;background:#2e2c2f;color:#fff}.widget-draggable{cursor:pointer}.widget-absolute{z-index:999999;position:absolute}.widget-opacity-25{opacity:.25}.widget-drag-overlay{font-size:20px;font-weight:700;color:#3b99fc;width:100%;height:100%;position:absolute;text-align:center;align-self:center;text-transform:uppercase;background:rgba(0,0,0,.9)}.widget-drag-text{font-family:var(--try-font-family);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%}")})();
