// ==UserScript==
// @name        tryrating-userscript
// @version     1.4.6
// @author      crashmax <userscript@crashmax.ru>
// @license     MIT
// @homepage    https://crashmax-dev.github.io/tryrating-userscript/
// @match       https://www.tryrating.com/app/survey/*
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_addStyle
// @grant       GM_notification
// @updateURL   https://crashmax-dev.github.io/tryrating-userscript/tryrating-userscript.meta.js
// @downloadURL https://crashmax-dev.github.io/tryrating-userscript/tryrating-userscript.user.js
// ==/UserScript==

(function(){"use strict";const rn={context:void 0,registry:void 0},on=(e,t)=>e===t,K=Symbol("solid-proxy"),lt=Symbol("solid-track"),xe={equals:on};let ct=mt;const te=1,Se=2,ut={owned:null,cleanups:null,context:null,owner:null};var I=null;let Fe=null,C=null,Y=null,X=null,De=0;function ft(e,t){const n=C,r=I,o=e.length===0,s=o?ut:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},i=o?e:()=>e(()=>R(()=>ke(s)));I=s,C=null;try{return ie(i,!0)}finally{C=n,I=r}}function Z(e,t){t=t?Object.assign({},xe,t):xe;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),pt(n,o));return[ht.bind(n),r]}function ne(e,t,n){const r=Ye(e,t,!1,te);he(r)}function J(e,t,n){ct=gn;const r=Ye(e,t,!1,te);(!n||!n.render)&&(r.user=!0),X?X.push(r):he(r)}function V(e,t,n){n=n?Object.assign({},xe,n):xe;const r=Ye(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,he(r),ht.bind(r)}function Q(e){return ie(e,!1)}function R(e){if(C===null)return e();const t=C;C=null;try{return e()}finally{C=t}}function dt(e){J(()=>R(e))}function ge(e){return I===null||(I.cleanups===null?I.cleanups=[e]:I.cleanups.push(e)),e}function gt(){return C}function sn(){return I}function an(e,t){const n=I,r=C;I=e,C=null;try{return ie(t,!0)}catch(o){ze(o)}finally{I=n,C=r}}function ln(e,t){const n=Symbol("context");return{id:n,Provider:pn(n),defaultValue:e}}function cn(e){let t;return(t=yt(I,e.id))!==void 0?t:e.defaultValue}function un(e){const t=V(e),n=V(()=>Be(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function ht(){if(this.sources&&this.state)if(this.state===te)he(this);else{const e=Y;Y=null,ie(()=>Me(this),!1),Y=e}if(C){const e=this.observers?this.observers.length:0;C.sources?(C.sources.push(this),C.sourceSlots.push(e)):(C.sources=[this],C.sourceSlots=[e]),this.observers?(this.observers.push(C),this.observerSlots.push(C.sources.length-1)):(this.observers=[C],this.observerSlots=[C.sources.length-1])}return this.value}function pt(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&ie(()=>{for(let o=0;o<e.observers.length;o+=1){const s=e.observers[o],i=Fe&&Fe.running;i&&Fe.disposed.has(s),(i?!s.tState:!s.state)&&(s.pure?Y.push(s):X.push(s),s.observers&&bt(s)),i||(s.state=te)}if(Y.length>1e6)throw Y=[],new Error},!1)),t}function he(e){if(!e.fn)return;ke(e);const t=I,n=C,r=De;C=I=e,fn(e,e.value,r),C=n,I=t}function fn(e,t,n){let r;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=te,e.owned&&e.owned.forEach(ke),e.owned=null),e.updatedAt=n+1,ze(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?pt(e,r):e.value=r,e.updatedAt=n)}function Ye(e,t,n,r=te,o){const s={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:null,pure:n};return I===null||I!==ut&&(I.owned?I.owned.push(s):I.owned=[s]),s}function Oe(e){if(e.state===0)return;if(e.state===Se)return Me(e);if(e.suspense&&R(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<De);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===te)he(e);else if(e.state===Se){const r=Y;Y=null,ie(()=>Me(e,t[0]),!1),Y=r}}function ie(e,t){if(Y)return e();let n=!1;t||(Y=[]),X?n=!0:X=[],De++;try{const r=e();return dn(n),r}catch(r){n||(X=null),Y=null,ze(r)}}function dn(e){if(Y&&(mt(Y),Y=null),e)return;const t=X;X=null,t.length&&ie(()=>ct(t),!1)}function mt(e){for(let t=0;t<e.length;t++)Oe(e[t])}function gn(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Oe(r)}for(t=0;t<n;t++)Oe(e[t])}function Me(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const o=r.state;o===te?r!==t&&(!r.updatedAt||r.updatedAt<De)&&Oe(r):o===Se&&Me(r,t)}}}function bt(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Se,n.pure?Y.push(n):X.push(n),n.observers&&bt(n))}}function ke(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const s=o.pop(),i=n.observerSlots.pop();r<o.length&&(s.sourceSlots[i]=r,o[r]=s,n.observerSlots[r]=i)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ke(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function hn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ze(e,t=I){throw hn(e)}function yt(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:yt(e.owner,t):void 0}function Be(e){if(typeof e=="function"&&!e.length)return Be(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Be(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function pn(e,t){return function(r){let o;return ne(()=>o=R(()=>(I.context={[e]:r.value},un(()=>r.children))),void 0),o}}function z(e,t){return R(()=>e(t||{}))}function Ae(){return!0}const mn={get(e,t,n){return t===K?n:e.get(t)},has(e,t){return t===K?!0:e.has(t)},set:Ae,deleteProperty:Ae,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Ae,deleteProperty:Ae}},ownKeys(e){return e.keys()}};function We(e){return(e=typeof e=="function"?e():e)?e:{}}function bn(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function yn(...e){let t=!1;for(let s=0;s<e.length;s++){const i=e[s];t=t||!!i&&K in i,e[s]=typeof i=="function"?(t=!0,V(i)):i}if(t)return new Proxy({get(s){for(let i=e.length-1;i>=0;i--){const l=We(e[i])[s];if(l!==void 0)return l}},has(s){for(let i=e.length-1;i>=0;i--)if(s in We(e[i]))return!0;return!1},keys(){const s=[];for(let i=0;i<e.length;i++)s.push(...Object.keys(We(e[i])));return[...new Set(s)]}},mn);const n={},r={},o=new Set;for(let s=e.length-1;s>=0;s--){const i=e[s];if(!i)continue;const l=Object.getOwnPropertyNames(i);for(let u=0,h=l.length;u<h;u++){const d=l[u];if(d==="__proto__"||d==="constructor")continue;const m=Object.getOwnPropertyDescriptor(i,d);if(!o.has(d))m.get?(o.add(d),Object.defineProperty(n,d,{enumerable:!0,configurable:!0,get:bn.bind(r[d]=[m.get.bind(i)])})):(m.value!==void 0&&o.add(d),n[d]=m.value);else{const v=r[d];v?m.get?v.push(m.get.bind(i)):m.value!==void 0&&v.push(()=>m.value):n[d]===void 0&&(n[d]=m.value)}}}return n}const vn=e=>`Stale read from <${e}>.`;function vt(e){const t=e.keyed,n=V(()=>e.when,void 0,{equals:(r,o)=>t?r===o:!r==!o});return V(()=>{const r=n();if(r){const o=e.children;return typeof o=="function"&&o.length>0?R(()=>o(t?r:()=>{if(!R(n))throw vn("Show");return e.when})):o}return e.fallback},void 0,void 0)}function wn(e,t,n){let r=n.length,o=t.length,s=r,i=0,l=0,u=t[o-1].nextSibling,h=null;for(;i<o||l<s;){if(t[i]===n[l]){i++,l++;continue}for(;t[o-1]===n[s-1];)o--,s--;if(o===i){const d=s<r?l?n[l-1].nextSibling:n[s-l]:u;for(;l<s;)e.insertBefore(n[l++],d)}else if(s===l)for(;i<o;)(!h||!h.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[s-1]&&n[l]===t[o-1]){const d=t[--o].nextSibling;e.insertBefore(n[l++],t[i++].nextSibling),e.insertBefore(n[--s],d),t[o]=n[s]}else{if(!h){h=new Map;let m=l;for(;m<s;)h.set(n[m],m++)}const d=h.get(t[i]);if(d!=null)if(l<d&&d<s){let m=i,v=1,$;for(;++m<o&&m<s&&!(($=h.get(t[m]))==null||$!==d+v);)v++;if(v>d-l){const x=t[i];for(;l<d;)e.insertBefore(n[l++],x)}else e.replaceChild(n[l++],t[i++])}else i++;else t[i++].remove()}}}const wt="_$DX_DELEGATE";function $n(e,t,n,r={}){let o;return ft(s=>{o=s,t===document?e():oe(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{o(),t.textContent=""}}function re(e,t,n){let r;const o=()=>{const i=document.createElement("template");return i.innerHTML=e,n?i.content.firstChild.firstChild:i.content.firstChild},s=t?()=>R(()=>document.importNode(r||(r=o()),!0)):()=>(r||(r=o())).cloneNode(!0);return s.cloneNode=s,s}function He(e,t=window.document){const n=t[wt]||(t[wt]=new Set);for(let r=0,o=e.length;r<o;r++){const s=e[r];n.has(s)||(n.add(s),t.addEventListener(s,Dn))}}function Tn(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function xn(e,t){t==null?e.removeAttribute("class"):e.className=t}function Sn(e,t,n){if(!t)return n?Tn(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let o,s;for(s in n)t[s]==null&&r.removeProperty(s),delete n[s];for(s in t)o=t[s],o!==n[s]&&(r.setProperty(s,o),n[s]=o);return n}function $t(e,t,n){return R(()=>e(t,n))}function oe(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return _e(e,t,r,n);ne(o=>_e(e,t(),o,n),r)}function Dn(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r.call(n,o,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function _e(e,t,n,r,o){for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,s==="string"||s==="number")if(s==="number"&&(t=t.toString()),i){let l=n[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),n=ce(e,n,r,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||s==="boolean")n=ce(e,n,r);else{if(s==="function")return ne(()=>{let l=t();for(;typeof l=="function";)l=l();n=_e(e,l,n,r)}),()=>n;if(Array.isArray(t)){const l=[],u=n&&Array.isArray(n);if(qe(l,t,n,o))return ne(()=>n=_e(e,l,n,r,!0)),()=>n;if(l.length===0){if(n=ce(e,n,r),i)return n}else u?n.length===0?Tt(e,l,r):wn(e,n,l):(n&&ce(e),Tt(e,l));n=l}else if(t.nodeType){if(Array.isArray(n)){if(i)return n=ce(e,n,r,t);ce(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}else console.warn("Unrecognized value. Skipped inserting",t)}return n}function qe(e,t,n,r){let o=!1;for(let s=0,i=t.length;s<i;s++){let l=t[s],u=n&&n[s],h;if(!(l==null||l===!0||l===!1))if((h=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))o=qe(e,l,u)||o;else if(h==="function")if(r){for(;typeof l=="function";)l=l();o=qe(e,Array.isArray(l)?l:[l],Array.isArray(u)?u:[u])||o}else e.push(l),o=!0;else{const d=String(l);u&&u.nodeType===3&&u.data===d?e.push(u):e.push(document.createTextNode(d))}}return o}function Tt(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function ce(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let s=!1;for(let i=t.length-1;i>=0;i--){const l=t[i];if(o!==l){const u=l.parentNode===e;!s&&!i?u?e.replaceChild(o,l):e.insertBefore(o,n):u&&l.remove()}else s=!0}}else e.insertBefore(o,n);return[o]}const On="http://www.w3.org/2000/svg";function Mn(e,t=!1){return t?document.createElementNS(On,e):document.createElement(e)}function kn(e){const{useShadow:t}=e,n=document.createTextNode(""),r=()=>e.mount||document.body,o=sn();let s,i=!!rn.context;return J(()=>{s||(s=an(o,()=>V(()=>e.children)));const l=r();if(l instanceof HTMLHeadElement){const[u,h]=Z(!1),d=()=>h(!0);ft(m=>oe(l,()=>u()?m():s(),null)),ge(d)}else{const u=Mn(e.isSVG?"g":"div",e.isSVG),h=t&&u.attachShadow?u.attachShadow({mode:"open"}):u;Object.defineProperty(u,"_$host",{get(){return n.parentNode},configurable:!0}),oe(h,s),l.appendChild(u),e.ref&&e.ref(u),ge(()=>l.removeChild(u))}},void 0,{render:!i}),n}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ve(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xt={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ge,function(){var n=1e3,r=6e4,o=36e5,s="millisecond",i="second",l="minute",u="hour",h="day",d="week",m="month",v="quarter",$="year",x="date",y="Invalid Date",D=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var a=["th","st","nd","rd"],c=T%100;return"["+T+(a[(c-20)%10]||a[c]||a[0])+"]"}},E=function(T,a,c){var f=String(T);return!f||f.length>=a?T:""+Array(a+1-f.length).join(c)+T},j={s:E,z:function(T){var a=-T.utcOffset(),c=Math.abs(a),f=Math.floor(c/60),g=c%60;return(a<=0?"+":"-")+E(f,2,"0")+":"+E(g,2,"0")},m:function T(a,c){if(a.date()<c.date())return-T(c,a);var f=12*(c.year()-a.year())+(c.month()-a.month()),g=a.clone().add(f,m),b=c-g<0,p=a.clone().add(f+(b?-1:1),m);return+(-(f+(c-g)/(b?g-p:p-g))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:m,y:$,w:d,d:h,D:x,h:u,m:l,s:i,ms:s,Q:v}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},M="en",L={};L[M]=_;var U=function(T){return T instanceof G},B=function T(a,c,f){var g;if(!a)return M;if(typeof a=="string"){var b=a.toLowerCase();L[b]&&(g=b),c&&(L[b]=c,g=b);var p=a.split("-");if(!g&&p.length>1)return T(p[0])}else{var w=a.name;L[w]=a,g=w}return!f&&g&&(M=g),g||!f&&M},k=function(T,a){if(U(T))return T.clone();var c=typeof a=="object"?a:{};return c.date=T,c.args=arguments,new G(c)},O=j;O.l=B,O.i=U,O.w=function(T,a){return k(T,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var G=function(){function T(c){this.$L=B(c.locale,null,!0),this.parse(c)}var a=T.prototype;return a.parse=function(c){this.$d=function(f){var g=f.date,b=f.utc;if(g===null)return new Date(NaN);if(O.u(g))return new Date;if(g instanceof Date)return new Date(g);if(typeof g=="string"&&!/Z$/i.test(g)){var p=g.match(D);if(p){var w=p[2]-1||0,S=(p[7]||"0").substring(0,3);return b?new Date(Date.UTC(p[1],w,p[3]||1,p[4]||0,p[5]||0,p[6]||0,S)):new Date(p[1],w,p[3]||1,p[4]||0,p[5]||0,p[6]||0,S)}}return new Date(g)}(c),this.$x=c.x||{},this.init()},a.init=function(){var c=this.$d;this.$y=c.getFullYear(),this.$M=c.getMonth(),this.$D=c.getDate(),this.$W=c.getDay(),this.$H=c.getHours(),this.$m=c.getMinutes(),this.$s=c.getSeconds(),this.$ms=c.getMilliseconds()},a.$utils=function(){return O},a.isValid=function(){return this.$d.toString()!==y},a.isSame=function(c,f){var g=k(c);return this.startOf(f)<=g&&g<=this.endOf(f)},a.isAfter=function(c,f){return k(c)<this.startOf(f)},a.isBefore=function(c,f){return this.endOf(f)<k(c)},a.$g=function(c,f,g){return O.u(c)?this[f]:this.set(g,c)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(c,f){var g=this,b=!!O.u(f)||f,p=O.p(c),w=function(le,H){var se=O.w(g.$u?Date.UTC(g.$y,H,le):new Date(g.$y,H,le),g);return b?se:se.endOf(h)},S=function(le,H){return O.w(g.toDate()[le].apply(g.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(H)),g)},A=this.$W,P=this.$M,W=this.$D,ee="set"+(this.$u?"UTC":"");switch(p){case $:return b?w(1,0):w(31,11);case m:return b?w(1,P):w(0,P+1);case d:var ae=this.$locale().weekStart||0,$e=(A<ae?A+7:A)-ae;return w(b?W-$e:W+(6-$e),P);case h:case x:return S(ee+"Hours",0);case u:return S(ee+"Minutes",1);case l:return S(ee+"Seconds",2);case i:return S(ee+"Milliseconds",3);default:return this.clone()}},a.endOf=function(c){return this.startOf(c,!1)},a.$set=function(c,f){var g,b=O.p(c),p="set"+(this.$u?"UTC":""),w=(g={},g[h]=p+"Date",g[x]=p+"Date",g[m]=p+"Month",g[$]=p+"FullYear",g[u]=p+"Hours",g[l]=p+"Minutes",g[i]=p+"Seconds",g[s]=p+"Milliseconds",g)[b],S=b===h?this.$D+(f-this.$W):f;if(b===m||b===$){var A=this.clone().set(x,1);A.$d[w](S),A.init(),this.$d=A.set(x,Math.min(this.$D,A.daysInMonth())).$d}else w&&this.$d[w](S);return this.init(),this},a.set=function(c,f){return this.clone().$set(c,f)},a.get=function(c){return this[O.p(c)]()},a.add=function(c,f){var g,b=this;c=Number(c);var p=O.p(f),w=function(P){var W=k(b);return O.w(W.date(W.date()+Math.round(P*c)),b)};if(p===m)return this.set(m,this.$M+c);if(p===$)return this.set($,this.$y+c);if(p===h)return w(1);if(p===d)return w(7);var S=(g={},g[l]=r,g[u]=o,g[i]=n,g)[p]||1,A=this.$d.getTime()+c*S;return O.w(A,this)},a.subtract=function(c,f){return this.add(-1*c,f)},a.format=function(c){var f=this,g=this.$locale();if(!this.isValid())return g.invalidDate||y;var b=c||"YYYY-MM-DDTHH:mm:ssZ",p=O.z(this),w=this.$H,S=this.$m,A=this.$M,P=g.weekdays,W=g.months,ee=g.meridiem,ae=function(H,se,Te,Ue){return H&&(H[se]||H(f,b))||Te[se].slice(0,Ue)},$e=function(H){return O.s(w%12||12,H,"0")},le=ee||function(H,se,Te){var Ue=H<12?"AM":"PM";return Te?Ue.toLowerCase():Ue};return b.replace(N,function(H,se){return se||function(Te){switch(Te){case"YY":return String(f.$y).slice(-2);case"YYYY":return O.s(f.$y,4,"0");case"M":return A+1;case"MM":return O.s(A+1,2,"0");case"MMM":return ae(g.monthsShort,A,W,3);case"MMMM":return ae(W,A);case"D":return f.$D;case"DD":return O.s(f.$D,2,"0");case"d":return String(f.$W);case"dd":return ae(g.weekdaysMin,f.$W,P,2);case"ddd":return ae(g.weekdaysShort,f.$W,P,3);case"dddd":return P[f.$W];case"H":return String(w);case"HH":return O.s(w,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return le(w,S,!0);case"A":return le(w,S,!1);case"m":return String(S);case"mm":return O.s(S,2,"0");case"s":return String(f.$s);case"ss":return O.s(f.$s,2,"0");case"SSS":return O.s(f.$ms,3,"0");case"Z":return p}return null}(H)||p.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(c,f,g){var b,p=this,w=O.p(f),S=k(c),A=(S.utcOffset()-this.utcOffset())*r,P=this-S,W=function(){return O.m(p,S)};switch(w){case $:b=W()/12;break;case m:b=W();break;case v:b=W()/3;break;case d:b=(P-A)/6048e5;break;case h:b=(P-A)/864e5;break;case u:b=P/o;break;case l:b=P/r;break;case i:b=P/n;break;default:b=P}return g?b:O.a(b)},a.daysInMonth=function(){return this.endOf(m).$D},a.$locale=function(){return L[this.$L]},a.locale=function(c,f){if(!c)return this.$L;var g=this.clone(),b=B(c,f,!0);return b&&(g.$L=b),g},a.clone=function(){return O.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},T}(),at=G.prototype;return k.prototype=at,[["$ms",s],["$s",i],["$m",l],["$H",u],["$W",h],["$M",m],["$y",$],["$D",x]].forEach(function(T){at[T[1]]=function(a){return this.$g(a,T[0],T[1])}}),k.extend=function(T,a){return T.$i||(T(a,G,k),T.$i=!0),k},k.locale=B,k.isDayjs=U,k.unix=function(T){return k(1e3*T)},k.en=L[M],k.Ls=L,k.p={},k})})(xt);var An=xt.exports;const ue=Ve(An);var St={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ge,function(){var n={year:0,month:1,day:2,hour:3,minute:4,second:5},r={};return function(o,s,i){var l,u=function(v,$,x){x===void 0&&(x={});var y=new Date(v),D=function(N,_){_===void 0&&(_={});var E=_.timeZoneName||"short",j=N+"|"+E,M=r[j];return M||(M=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:N,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:E}),r[j]=M),M}($,x);return D.formatToParts(y)},h=function(v,$){for(var x=u(v,$),y=[],D=0;D<x.length;D+=1){var N=x[D],_=N.type,E=N.value,j=n[_];j>=0&&(y[j]=parseInt(E,10))}var M=y[3],L=M===24?0:M,U=y[0]+"-"+y[1]+"-"+y[2]+" "+L+":"+y[4]+":"+y[5]+":000",B=+v;return(i.utc(U).valueOf()-(B-=B%1e3))/6e4},d=s.prototype;d.tz=function(v,$){v===void 0&&(v=l);var x=this.utcOffset(),y=this.toDate(),D=y.toLocaleString("en-US",{timeZone:v}),N=Math.round((y-new Date(D))/1e3/60),_=i(D).$set("millisecond",this.$ms).utcOffset(15*-Math.round(y.getTimezoneOffset()/15)-N,!0);if($){var E=_.utcOffset();_=_.add(x-E,"minute")}return _.$x.$timezone=v,_},d.offsetName=function(v){var $=this.$x.$timezone||i.tz.guess(),x=u(this.valueOf(),$,{timeZoneName:v}).find(function(y){return y.type.toLowerCase()==="timezonename"});return x&&x.value};var m=d.startOf;d.startOf=function(v,$){if(!this.$x||!this.$x.$timezone)return m.call(this,v,$);var x=i(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return m.call(x,v,$).tz(this.$x.$timezone,!0)},i.tz=function(v,$,x){var y=x&&$,D=x||$||l,N=h(+i(),D);if(typeof v!="string")return i(v).tz(D);var _=function(L,U,B){var k=L-60*U*1e3,O=h(k,B);if(U===O)return[k,U];var G=h(k-=60*(O-U)*1e3,B);return O===G?[k,O]:[L-60*Math.min(O,G)*1e3,Math.max(O,G)]}(i.utc(v,y).valueOf(),N,D),E=_[0],j=_[1],M=i(E).utcOffset(j);return M.$x.$timezone=D,M},i.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},i.tz.setDefault=function(v){l=v}}})})(St);var _n=St.exports;const En=Ve(_n);var Dt={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ge,function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,o=/([+-]|\d\d)/g;return function(s,i,l){var u=i.prototype;l.utc=function(y){var D={date:y,utc:!0,args:arguments};return new i(D)},u.utc=function(y){var D=l(this.toDate(),{locale:this.$L,utc:!0});return y?D.add(this.utcOffset(),n):D},u.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var h=u.parse;u.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),h.call(this,y)};var d=u.init;u.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else d.call(this)};var m=u.utcOffset;u.utcOffset=function(y,D){var N=this.$utils().u;if(N(y))return this.$u?0:N(this.$offset)?m.call(this):this.$offset;if(typeof y=="string"&&(y=function(M){M===void 0&&(M="");var L=M.match(r);if(!L)return null;var U=(""+L[0]).match(o)||["-",0,0],B=U[0],k=60*+U[1]+ +U[2];return k===0?0:B==="+"?k:-k}(y),y===null))return this;var _=Math.abs(y)<=16?60*y:y,E=this;if(D)return E.$offset=_,E.$u=y===0,E;if(y!==0){var j=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(E=this.local().add(_+j,n)).$offset=_,E.$x.$localOffset=j}else E=this.utc();return E};var v=u.format;u.format=function(y){var D=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return v.call(this,D)},u.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},u.isUTC=function(){return!!this.$u},u.toISOString=function(){return this.toDate().toISOString()},u.toString=function(){return this.toDate().toUTCString()};var $=u.toDate;u.toDate=function(y){return y==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():$.call(this)};var x=u.diff;u.diff=function(y,D,N){if(y&&this.$u===y.$u)return x.call(this,y,D,N);var _=this.local(),E=l(y).local();return x.call(_,E,D,N)}}})})(Dt);var Cn=Dt.exports;const In=Ve(Cn);ue.extend(In),ue.extend(En);const Ot={offset:180,region:"Asia",location:"Kuwait"};function Ee(){return ue.tz(new Date,`${Ot.region}/${Ot.location}`).format("DD.MM.YYYY")}function Ln(e){return Object.entries(e)}function Ce(e){return e=Math.abs(e),e>9?`${e}`:`0${e}`}function Pn(e=0,t=Number.MAX_SAFE_INTEGER-1){return Math.floor(Math.random()*(t-e+1))+e}const Mt={info:"#2ecc71",debug:"#7f8c8d",warn:"#f39c12",error:"#c0392b"};function Nn(e){return[`background: ${Mt[e]}`,"border-radius: 0.5em","color: white","font-weight: bold","padding: 2px 0.5em","font-family: cursive"].join(";")}const q=Object.freeze(Ln(Mt).reduce((e,[t])=>(e[t]=(...n)=>{console[t]("%ctryrating-userscript",Nn(t),...n)},e),{})),Ke=()=>[{date:Ee(),total:0,estimated:0,list:[]}],[pe,Xe]=Z([]);class jn{STORAGE_KEY="tryrating-storage-v3";constructor(){this.read()}get taskList(){return pe()}read(){const t=GM_getValue(this.STORAGE_KEY,Ke());q.info("Readed tasks",t),Xe(t)}reset(){Xe(Ke()),GM_setValue(this.STORAGE_KEY,pe())}write(t){const n=this.getTaskList();n.total+=1,n.estimated+=t.estimated;const r=n.list.find(s=>s.type===t.type);r?(r.count+=1,r.estimated+=t.estimated):n.list.push({count:1,type:t.type,estimated:t.estimated});const o=[n,...pe().filter(s=>s.date!==n.date)];Xe(o),GM_setValue(this.STORAGE_KEY,pe())}getTaskList(){const t=Ee();q.info("Current date",t);const n=pe().find(r=>r.date===t);return q.info("Task list",n),n||Ke()[0]}}const Ie=new jn;function F(e,t,...n){const r=document.createElement(e);return t instanceof Node?r.append(t):typeof t=="string"?r.append(Rn(t)):Array.isArray(t)?r.append(...t):(Object.assign(r,t),Object.assign(r.style,t?.style)),r.append(...n),r}function Rn(e){return document.createTextNode(e)}function kt(e,t,n){const r=new MutationObserver((o,s)=>{for(const i of o)t(i,s)});return r.observe(e,{childList:!0,subtree:!0,...n}),()=>r.disconnect()}function Un(e,t=document.body){return new Promise(n=>{kt(t,(r,o)=>{const s=t.querySelector(e);s&&(o.disconnect(),n(s))})})}function At(e){return Ce(Number((e%6e4/1e3).toFixed(0)))}function _t(e){const t=Ce(Math.floor(e/6e4)),n=At(e);return`${t}:${n}`}function Et(e){const t=Ce(Math.floor(e/36e5)),n=Ce(Math.floor(e%36e5/6e4)),r=At(e);return`${t}:${n}:${r}`}const Fn=`function savePage() {
  const body = document.body.cloneNode(true)
  body.querySelector('button')?.remove()
  body.querySelector('script')?.remove()

  const blob = new Blob([body.outerHTML], {
    type: 'text/html'
  })

  const link = document.createElement('a')
  Object.assign(link, {
    target: '_blank',
    href: URL.createObjectURL(blob),
    download: 'tryrating-__DATE__.html'
  })

  link.click()
}
`,Yn=`* {
  margin: 0;
  box-sizing: border-box;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

table {
  width: 100%;
  border-collapse: collapse;
  border: 1px solid #ddd;
}

caption {
  background: linear-gradient(to bottom, #f2f2f2, #e6e6e6);
  color: #333;
  font-weight: bold;
  font-size: 18px;
  padding: 10px;
  text-align: center;
}

p {
  text-align: start;
}

th {
  background-color: #f2f2f2;
  font-weight: bold;
  padding: 8px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

td {
  padding: 8px;
  border-bottom: 1px solid #ddd;
}

tr:nth-child(even) {
  background-color: #f9f9f9;
}

tr:hover {
  background-color: #e6e6e6;
}

td:hover {
  background-color: #e6e6e6;
}

th:first-child,
td:first-child {
  width: 80%;
}

th:nth-child(2),
td:nth-child(2) {
  width: 10%;
}

th:nth-child(3),
td:nth-child(3) {
  width: 10%;
}

button {
  font-family: inherit;
  font-weight: 600;
  position: fixed;
  right: 1rem;
  top: 1rem;
  display: inline-block;
  border: none;
  padding: 10px 20px;
  background-color: #f5f5f5;
  color: #333;
  font-size: 1rem;
  text-align: center;
  text-decoration: none;
  cursor: pointer;
  border-collapse: collapse;
  border-spacing: 0;
  border: 1px solid #ddd;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.4);
}

button:hover {
  background-color: #e0e0e0;
}

button:focus {
  outline: none;
  box-shadow: 0 0 0 2px #999;
}
`;class fe{static page(){const t=F("style",Yn),n=F("script",Fn.replace("__DATE__",Ee())),r=F("button",{className:"save-button"},"Save");return r.setAttribute("onclick","savePage()"),F("div",r,t,n)}static table(){return F("table")}static caption(t,n,r){return F("caption",F("p",`Date: ${t}`),F("p",`Tasks: ${n}`),F("p",`Estimated: ${Et(r)}`))}static head(){return F("tr",F("th","Task"),F("th","Count"),F("th","Estimated"))}static tr(t){return F("tr",F("td",t.type),F("td",`${t.count}`),F("td",Et(t.estimated)))}static open(t){const n=new Blob([t.outerHTML],{type:"text/html"});F("a",{target:"_blank",href:URL.createObjectURL(n)}).click()}}class zn{generateMonthyPage(){}generateDailyPage(){const t=fe.page();for(const{date:n,list:r,total:o,estimated:s}of Ie.taskList){const i=fe.table(),l=fe.caption(n,o,s);i.append(l);const u=fe.head();i.append(u);for(const h of r){const d=fe.tr(h);i.append(d)}t.prepend(i)}fe.open(t)}}const Ct=new zn,Bn=re("<button>A"),[Ze,Wn]=Z(!0);class Hn{get isAutoSubmit(){return Ze()}toggle(){Wn(!Ze())}}const me=new Hn,qn=()=>(()=>{const e=Bn();return e.$$click=()=>me.toggle(),ne(()=>e.classList.toggle("enabled",!!Ze())),e})();He(["click"]);const Je=Symbol("store-raw"),be=Symbol("store-node");function It(e){let t=e[K];if(!t&&(Object.defineProperty(e,K,{value:t=new Proxy(e,Kn)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let o=0,s=n.length;o<s;o++){const i=n[o];r[i].get&&Object.defineProperty(e,i,{enumerable:r[i].enumerable,get:r[i].get.bind(t)})}}return t}function Le(e){let t;return e!=null&&typeof e=="object"&&(e[K]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function ye(e,t=new Set){let n,r,o,s;if(n=e!=null&&e[Je])return n;if(!Le(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,l=e.length;i<l;i++)o=e[i],(r=ye(o,t))!==o&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let u=0,h=i.length;u<h;u++)s=i[u],!l[s].get&&(o=e[s],(r=ye(o,t))!==o&&(e[s]=r))}return e}function Qe(e){let t=e[be];return t||Object.defineProperty(e,be,{value:t=Object.create(null)}),t}function et(e,t,n){return e[t]||(e[t]=Pt(n))}function Gn(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===K||t===be||(delete n.value,delete n.writable,n.get=()=>e[K][t]),n}function Lt(e){if(gt()){const t=Qe(e);(t._||(t._=Pt()))()}}function Vn(e){return Lt(e),Reflect.ownKeys(e)}function Pt(e){const[t,n]=Z(e,{equals:!1,internal:!0});return t.$=n,t}const Kn={get(e,t,n){if(t===Je)return e;if(t===K)return n;if(t===lt)return Lt(e),n;const r=Qe(e),o=r[t];let s=o?o():e[t];if(t===be||t==="__proto__")return s;if(!o){const i=Object.getOwnPropertyDescriptor(e,t);gt()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(i&&i.get)&&(s=et(r,t,s)())}return Le(s)?It(s):s},has(e,t){return t===Je||t===K||t===lt||t===be||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Vn,getOwnPropertyDescriptor:Gn};function Pe(e,t,n,r=!1){if(!r&&e[t]===n)return;const o=e[t],s=e.length;n===void 0?delete e[t]:e[t]=n;let i=Qe(e),l;if((l=et(i,t,o))&&l.$(()=>n),Array.isArray(e)&&e.length!==s){for(let u=e.length;u<s;u++)(l=i[u])&&l.$();(l=et(i,"length",s))&&l.$(e.length)}(l=i._)&&l.$()}function Nt(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];Pe(e,o,t[o])}}function Xn(e,t){if(typeof t=="function"&&(t=t(e)),t=ye(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const o=t[n];e[n]!==o&&Pe(e,n,o)}Pe(e,"length",r)}else Nt(e,t)}function ve(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,l=Array.isArray(e);if(Array.isArray(r)){for(let u=0;u<r.length;u++)ve(e,[r[u]].concat(t),n);return}else if(l&&i==="function"){for(let u=0;u<e.length;u++)r(e[u],u)&&ve(e,[u].concat(t),n);return}else if(l&&i==="object"){const{from:u=0,to:h=e.length-1,by:d=1}=r;for(let m=u;m<=h;m+=d)ve(e,[m].concat(t),n);return}else if(t.length>1){ve(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let s=t[0];typeof s=="function"&&(s=s(o,n),s===o)||r===void 0&&s==null||(s=ye(s),r===void 0||Le(o)&&Le(s)&&!Array.isArray(s)?Nt(o,s):Pe(e,r,s))}function jt(...[e,t]){const n=ye(e||{}),r=Array.isArray(n),o=It(n);function s(...i){Q(()=>{r&&i.length===1?Xn(n,i[0]):ve(n,i)})}return[o,s]}const Zn=re("<div>");var Ne=class{x;y;width;height;constructor(e){this.x=Math.floor(e.x),this.y=Math.floor(e.y),this.width=Math.floor(e.width),this.height=Math.floor(e.height)}get rect(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get center(){return{x:this.x+this.width*.5,y:this.y+this.height*.5}}get corners(){return{topLeft:{x:this.left,y:this.top},topRight:{x:this.right,y:this.top},bottomRight:{x:this.left,y:this.bottom},bottomLeft:{x:this.right,y:this.bottom}}}},we=e=>{let t=new Ne(e.getBoundingClientRect());const{transform:n}=getComputedStyle(e);return n&&(t=Jn(t,n)),t},Jn=(e,t)=>{let n,r;if(t.startsWith("matrix3d(")){const o=t.slice(9,-1).split(/, /);n=+o[12],r=+o[13]}else if(t.startsWith("matrix(")){const o=t.slice(7,-1).split(/, /);n=+o[4],r=+o[5]}else n=0,r=0;return new Ne({...e,x:e.x-n,y:e.y-r})},de=()=>({x:0,y:0}),Qn=(e,t)=>e.x===t.x&&e.y===t.y,tt=(e,t)=>new Ne({...e,x:e.x+t.x,y:e.y+t.y}),er=(e,t)=>{const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),o=Math.min(e.right,t.right),s=Math.min(e.bottom,t.bottom),i=o-r,l=s-n;if(r<o&&n<s){const u=e.width*e.height,h=t.width*t.height,d=i*l;return d/(u+h-d)}return 0},nt=(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,tr=(e,t,n)=>{const r=e.transformed,o={ratio:0,droppable:null};for(const s of t){const i=er(r,s.layout);i>o.ratio?(o.ratio=i,o.droppable=s):i>0&&i===o.ratio&&s.id===n.activeDroppableId&&(o.droppable=s)}return o.droppable},Rt=ln(),nr=e=>{const t=yn({collisionDetector:tr},e),[n,r]=jt({draggables:{},droppables:{},sensors:{},active:{draggableId:null,get draggable(){return n.active.draggableId!==null?n.draggables[n.active.draggableId]:null},droppableId:null,get droppable(){return n.active.droppableId!==null?n.droppables[n.active.droppableId]:null},sensorId:null,get sensor(){return n.active.sensorId!==null?n.sensors[n.active.sensorId]:null},overlay:null}}),o=(a,c,f)=>{a.substring(0,a.length-1),R(()=>n[a][c])&&r(a,c,"transformers",f.id,f)},s=(a,c,f)=>{a.substring(0,a.length-1),R(()=>n[a][c])&&R(()=>n[a][c].transformers[f])&&r(a,c,"transformers",f,void 0)},i=({id:a,node:c,layout:f,data:g})=>{const b=n.draggables[a],p={id:a,node:c,layout:f,data:g,_pendingCleanup:!1};let w;if(!b)Object.defineProperties(p,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{if(n.active.overlay)return de();const S=Object.values(n.draggables[a].transformers);return S.sort((A,P)=>A.order-P.order),S.reduce((A,P)=>P.callback(A),de())}},transformed:{enumerable:!0,configurable:!0,get:()=>tt(n.draggables[a].layout,n.draggables[a].transform)}});else if(n.active.draggableId===a&&!n.active.overlay){const S={x:b.layout.x-f.x,y:b.layout.y-f.y},A="addDraggable-existing-offset",P=b.transformers[A],W=P?P.callback(S):S;w={id:A,order:100,callback:ee=>({x:ee.x+W.x,y:ee.y+W.y})},G(()=>s("draggables",a,A))}Q(()=>{r("draggables",a,p),w&&o("draggables",a,w)}),n.active.draggable&&j()},l=a=>{R(()=>n.draggables[a])&&(r("draggables",a,"_pendingCleanup",!0),queueMicrotask(()=>u(a)))},u=a=>{if(n.draggables[a]?._pendingCleanup){const c=n.active.draggableId===a;Q(()=>{c&&r("active","draggableId",null),r("draggables",a,void 0)})}},h=({id:a,node:c,layout:f,data:g})=>{const b=n.droppables[a],p={id:a,node:c,layout:f,data:g,_pendingCleanup:!1};b||Object.defineProperties(p,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{const w=Object.values(n.droppables[a].transformers);return w.sort((S,A)=>S.order-A.order),w.reduce((S,A)=>A.callback(S),de())}},transformed:{enumerable:!0,configurable:!0,get:()=>tt(n.droppables[a].layout,n.droppables[a].transform)}}),r("droppables",a,p),n.active.draggable&&j()},d=a=>{R(()=>n.droppables[a])&&(r("droppables",a,"_pendingCleanup",!0),queueMicrotask(()=>m(a)))},m=a=>{if(n.droppables[a]?._pendingCleanup){const c=n.active.droppableId===a;Q(()=>{c&&r("active","droppableId",null),r("droppables",a,void 0)})}},v=({id:a,activators:c})=>{r("sensors",a,{id:a,activators:c,coordinates:{origin:{x:0,y:0},current:{x:0,y:0},get delta(){return{x:n.sensors[a].coordinates.current.x-n.sensors[a].coordinates.origin.x,y:n.sensors[a].coordinates.current.y-n.sensors[a].coordinates.origin.y}}}})},$=a=>{if(!R(()=>n.sensors[a]))return;const c=n.active.sensorId===a;Q(()=>{c&&r("active","sensorId",null),r("sensors",a,void 0)})},x=({node:a,layout:c})=>{const f=n.active.overlay,g={node:a,layout:c};f||Object.defineProperties(g,{id:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.id},data:{enumerable:!0,configurable:!0,get:()=>n.active.draggable?.data},transformers:{enumerable:!0,configurable:!0,get:()=>Object.fromEntries(Object.entries(n.active.draggable?n.active.draggable.transformers:{}).filter(([b])=>b!=="addDraggable-existing-offset"))},transform:{enumerable:!0,configurable:!0,get:()=>{const b=Object.values(n.active.overlay?n.active.overlay.transformers:[]);return b.sort((p,w)=>p.order-w.order),b.reduce((p,w)=>w.callback(p),de())}},transformed:{enumerable:!0,configurable:!0,get:()=>n.active.overlay?tt(n.active.overlay.layout,n.active.overlay.transform):new Ne({x:0,y:0,width:0,height:0})}}),r("active","overlay",g)},y=()=>r("active","overlay",null),D=(a,c)=>{Q(()=>{r("sensors",a,"coordinates",{origin:{...c},current:{...c}}),r("active","sensorId",a)})},N=a=>{const c=n.active.sensorId;c&&r("sensors",c,"coordinates","current",{...a})},_=()=>r("active","sensorId",null),E=(a,c)=>{const f={};for(const b of Object.values(n.sensors))if(b)for(const[p,w]of Object.entries(b.activators))f[p]??=[],f[p].push({sensor:b,activator:w});const g={};for(const b in f){let p=b;c&&(p=`on${b}`),g[p]=w=>{for(const{activator:S}of f[b]){if(n.active.sensor)break;S(w,a)}}}return g},j=()=>{let a=!1;const c=Object.values(n.draggables),f=Object.values(n.droppables),g=n.active.overlay;return Q(()=>{const b=new WeakMap;for(const p of c)if(p){const w=p.layout;b.has(p.node)||b.set(p.node,we(p.node));const S=b.get(p.node);nt(w,S)||(r("draggables",p.id,"layout",S),a=!0)}for(const p of f)if(p){const w=p.layout;b.has(p.node)||b.set(p.node,we(p.node));const S=b.get(p.node);nt(w,S)||(r("droppables",p.id,"layout",S),a=!0)}if(g){const p=g.layout,w=we(g.node);nt(p,w)||(r("active","overlay","layout",w),a=!0)}}),a},M=()=>{const a=n.active.overlay??n.active.draggable;if(a){const c=t.collisionDetector(a,Object.values(n.droppables),{activeDroppableId:n.active.droppableId}),f=c?c.id:null;n.active.droppableId!==f&&r("active","droppableId",f)}},L=a=>{const c={id:"sensorMove",order:0,callback:f=>n.active.sensor?{x:f.x+n.active.sensor.coordinates.delta.x,y:f.y+n.active.sensor.coordinates.delta.y}:f};j(),Q(()=>{r("active","draggableId",a),o("draggables",a,c)}),M()},U=()=>{const a=R(()=>n.active.draggableId);Q(()=>{a!==null&&s("draggables",a,"sensorMove"),r("active",["draggableId","droppableId"],null)}),j()},B=a=>{J(()=>{const c=n.active.draggable;c&&R(()=>a({draggable:c}))})},k=a=>{J(()=>{const c=n.active.draggable;if(c){const f=R(()=>n.active.overlay);Object.values(f?f.transform:c.transform),R(()=>a({draggable:c,overlay:f}))}})},O=a=>{J(()=>{const c=n.active.draggable,f=n.active.droppable;c&&R(()=>a({draggable:c,droppable:f,overlay:n.active.overlay}))})},G=a=>{J(({previousDraggable:c,previousDroppable:f,previousOverlay:g})=>{const b=n.active.draggable,p=b?n.active.droppable:null,w=b?n.active.overlay:null;return!b&&c&&R(()=>a({draggable:c,droppable:f,overlay:g})),{previousDraggable:b,previousDroppable:p,previousOverlay:w}},{previousDraggable:null,previousDroppable:null,previousOverlay:null})};k(()=>M()),t.onDragStart&&B(t.onDragStart),t.onDragMove&&k(t.onDragMove),t.onDragOver&&O(t.onDragOver),t.onDragEnd&&G(t.onDragEnd);const T=[n,{addTransformer:o,removeTransformer:s,addDraggable:i,removeDraggable:l,addDroppable:h,removeDroppable:d,addSensor:v,removeSensor:$,setOverlay:x,clearOverlay:y,recomputeLayouts:j,detectCollisions:M,draggableActivators:E,sensorStart:D,sensorMove:N,sensorEnd:_,dragStart:L,dragEnd:U,onDragStart:B,onDragMove:k,onDragOver:O,onDragEnd:G}];return z(Rt.Provider,{value:T,get children(){return t.children}})},rt=()=>cn(Rt)||null,rr=(e="pointer-sensor")=>{const[t,{addSensor:n,removeSensor:r,sensorStart:o,sensorMove:s,sensorEnd:i,dragStart:l,dragEnd:u}]=rt(),h=250,d=10;dt(()=>{n({id:e,activators:{pointerdown:y}})}),ge(()=>{r(e)});const m=()=>t.active.sensorId===e,v={x:0,y:0};let $=null,x=null;const y=(M,L)=>{M.button===0&&(document.addEventListener("pointermove",_),document.addEventListener("pointerup",E),x=L,v.x=M.clientX,v.y=M.clientY,$=window.setTimeout(N,h))},D=()=>{$&&(clearTimeout($),$=null),document.removeEventListener("pointermove",_),document.removeEventListener("pointerup",E),document.removeEventListener("selectionchange",j)},N=()=>{t.active.sensor?m()||D():(o(e,v),l(x),j(),document.addEventListener("selectionchange",j))},_=M=>{const L={x:M.clientX,y:M.clientY};if(!t.active.sensor){const U={x:L.x-v.x,y:L.y-v.y};Math.sqrt(U.x**2+U.y**2)>d&&N()}m()&&(M.preventDefault(),s(L))},E=M=>{D(),m()&&(M.preventDefault(),u(),i())},j=()=>{window.getSelection()?.removeAllRanges()}},or=e=>(rr(),V(()=>e.children)),Ut=e=>({transform:`translate3d(${e.x}px, ${e.y}px, 0)`}),sr=(e,t={})=>{const[n,{addDraggable:r,removeDraggable:o,draggableActivators:s}]=rt(),[i,l]=Z(null);dt(()=>{const m=i();m&&r({id:e,node:m,layout:we(m),data:t})}),ge(()=>o(e));const u=()=>n.active.draggableId===e,h=()=>n.draggables[e]?.transform||de();return Object.defineProperties((m,v)=>{const $=v?v():{};J(()=>{const x=i(),y=s(e);if(x)for(const D in y)x.addEventListener(D,y[D]);ge(()=>{if(x)for(const D in y)x.removeEventListener(D,y[D])})}),l(m),$.skipTransform||J(()=>{const x=h();if(Qn(x,de()))m.style.removeProperty("transform");else{const y=Ut(h());m.style.setProperty("transform",y.transform??null)}})},{ref:{enumerable:!0,value:l},isActiveDraggable:{enumerable:!0,get:u},dragActivators:{enumerable:!0,get:()=>s(e,!0)},transform:{enumerable:!0,get:h}})},ir=e=>{const[t,{onDragStart:n,onDragEnd:r,setOverlay:o,clearOverlay:s}]=rt();let i;n(({draggable:u})=>{o({node:u.node,layout:u.layout}),queueMicrotask(()=>{if(i){const h=we(i),d={x:(u.layout.width-h.width)/2,y:(u.layout.height-h.height)/2};h.x+=d.x,h.y+=d.y,o({node:i,layout:h})}})}),r(()=>queueMicrotask(s));const l=()=>{const u=t.active.overlay,h=t.active.draggable;return!u||!h?{}:{position:"fixed",transition:"transform 0s",top:`${u.layout.top}px`,left:`${u.layout.left}px`,"min-width":`${h.layout.width}px`,"min-height":`${h.layout.height}px`,...Ut(u.transform),...e.style}};return z(kn,{get mount(){return document.body},get children(){return z(vt,{get when(){return t.active.draggable},get children(){const u=Zn(),h=i;return typeof h=="function"?$t(h,u):i=u,oe(u,(()=>{const d=V(()=>typeof e.children=="function");return()=>d()?e.children(t.active.draggable):e.children})()),ne(d=>{const m=e.class,v=l();return m!==d._v$&&xn(u,d._v$=m),d._v$2=Sn(u,v,d._v$2),d},{_v$:void 0,_v$2:void 0}),u}})}})};function Ft(e,t){const n=GM_getValue(e,t),[r,o]=jt(n);return J(()=>GM_setValue(e,r)),[r,o]}const ar=re('<div class="tryrating-widget draggable absolute">'),lr=re('<div class="widget-drag-overlay"><span class="text">alt+3 reset position'),[Yt,zt]=Ft("widget-position",{top:"0px",left:"0px"});function cr(){zt({top:"0px",left:"0px"})}const ur=e=>{const t=sr(e.id);return(()=>{const n=ar();return $t(t,n,()=>!0),oe(n,()=>e.children),ne(r=>{const o=!!t.isActiveDraggable,s=Yt.top,i=Yt.left;return o!==r._v$&&n.classList.toggle("opacity-25",r._v$=o),s!==r._v$2&&((r._v$2=s)!=null?n.style.setProperty("top",s):n.style.removeProperty("top")),i!==r._v$3&&((r._v$3=i)!=null?n.style.setProperty("left",i):n.style.removeProperty("left")),r},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()},fr=e=>{let t={x:0,y:0};return z(nr,{onDragMove:({overlay:o})=>{o&&(t={...o.transform})},onDragEnd:({draggable:o})=>{const s=o.node,i=`${s.offsetTop+t.y}px`,l=`${s.offsetLeft+t.x}px`;zt({top:i,left:l})},get children(){return[z(or,{}),z(ur,{id:1,get children(){return e.children}}),z(ir,{children:o=>[lr(),o]})]}})},[Bt,dr]=Z(!0);function gr(){dr(!Bt())}const hr=e=>z(vt,{get when(){return Bt()},get children(){return e.children}});function pr(){window.addEventListener("keydown",e=>{e.altKey&&e.key==="1"&&(e.preventDefault(),Ct.generateDailyPage()),e.altKey&&e.key==="2"&&(e.preventDefault(),confirm(`Reset data.
Are you sure?`)&&Ie.reset()),e.altKey&&e.key==="3"&&(e.preventDefault(),cr()),e.ctrlKey&&e.code==="KeyO"&&(e.preventDefault(),me.toggle()),e.ctrlKey&&e.code==="KeyX"&&(e.preventDefault(),gr())})}const mr=e=>(t,n)=>(e.set(t,n),n),Wt=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Ht=536870912,qt=Ht*2,br=(e,t)=>n=>{const r=t.get(n);let o=r===void 0?n.size:r<qt?r+1:0;if(!n.has(o))return e(n,o);if(n.size<Ht){for(;n.has(o);)o=Math.floor(Math.random()*qt);return e(n,o)}if(n.size>Wt)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(o);)o=Math.floor(Math.random()*Wt);return e(n,o)},Gt=new WeakMap,yr=mr(Gt),je=br(yr,Gt),vr=e=>e.method!==void 0&&e.method==="call",wr=e=>e.error===null&&typeof e.id=="number",Vt=((e,t)=>{let n=null;return()=>{if(n!==null)return n;const r=new Blob([t],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return n=e(o),setTimeout(()=>URL.revokeObjectURL(o)),n}})(e=>{const t=new Map([[0,()=>{}]]),n=new Map([[0,()=>{}]]),r=new Map,o=new Worker(e);return o.addEventListener("message",({data:h})=>{if(vr(h)){const{params:{timerId:d,timerType:m}}=h;if(m==="interval"){const v=t.get(d);if(typeof v=="number"){const $=r.get(v);if($===void 0||$.timerId!==d||$.timerType!==m)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v();else throw new Error("The timer is in an undefined state.")}else if(m==="timeout"){const v=n.get(d);if(typeof v=="number"){const $=r.get(v);if($===void 0||$.timerId!==d||$.timerType!==m)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v(),n.delete(d);else throw new Error("The timer is in an undefined state.")}}else if(wr(h)){const{id:d}=h,m=r.get(d);if(m===void 0)throw new Error("The timer is in an undefined state.");const{timerId:v,timerType:$}=m;r.delete(d),$==="interval"?t.delete(v):n.delete(v)}else{const{error:{message:d}}=h;throw new Error(d)}}),{clearInterval:h=>{const d=je(r);r.set(d,{timerId:h,timerType:"interval"}),t.set(h,d),o.postMessage({id:d,method:"clear",params:{timerId:h,timerType:"interval"}})},clearTimeout:h=>{const d=je(r);r.set(d,{timerId:h,timerType:"timeout"}),n.set(h,d),o.postMessage({id:d,method:"clear",params:{timerId:h,timerType:"timeout"}})},setInterval:(h,d)=>{const m=je(t);return t.set(m,()=>{h(),typeof t.get(m)=="function"&&o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:m,timerType:"interval"}})}),o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:m,timerType:"interval"}}),m},setTimeout:(h,d)=>{const m=je(n);return n.set(m,h),o.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:m,timerType:"timeout"}}),m}}},`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`),Kt=e=>Vt().clearInterval(e),ot=(e,t)=>Vt().setInterval(e,t),$r=".modal-container.visible",Tr="div[modalwrapref] > div",Xt="Validation failed!",[Zt,xr]=Ft("auto-close-modal",{value:!0});class Sr{get autoClose(){return Zt.value}toggleAutoClose(){xr({value:!Zt.value})}closeValidationFailed(){const t=document.querySelector($r);if(!t)return;const n=t.querySelector(Tr);if(n&&n.textContent===Xt){GM_notification({title:document.title,text:Xt,highlight:!0,silent:!1,timeout:1e3});const r=t.querySelector("button");r&&(q.info("Modal closed"),r.click())}}}const Re=new Sr;function Dr(e){const t=e.split(/\s(?=\d)/);let n=0;for(const r of t){const[o,s]=r.split(" ");switch(s){case"hours":n+=ue().hour(Number(o)).millisecond();break;case"minutes":n+=ue().minute(Number(o)).millisecond();break;case"seconds":n+=ue().second(Number(o)).millisecond();break;default:q.warn(`Unknown time type: ${s}`)}}return n}const[Or,Jt]=Z(0);let Mr=class{intervalId;get time(){return Or()}tick(){Jt(t=>t+1e3)}start(){this.intervalId&&(Kt(this.intervalId),Jt(0)),this.intervalId=ot(()=>this.tick(),1e3)}};const Qt=new Mr,kr=".btn-success",Ar="Submit Rating",[en,_r]=Z(!0);class Er{get isAutoSubmit(){return en()}toggleAutoSubmit(){_r(!en())}getSubmitButtons(){const t=[],n=Array.from(document.querySelectorAll(kr));for(const r of n)r instanceof HTMLButtonElement&&r.textContent===Ar&&t.push(r);return t}clickSubmit(){if(!me.isAutoSubmit)return;const t=this.getSubmitButtons();if(!t.length){q.error("Submit button is not defined");return}t[0].click()}}const Cr=new Er,[tn,nn]=Z(0);let Ir=class{intervalId;onEndCallback;onTickTimer(){const t=tn()-1e3;nn(t),t===0&&(this.onEndCallback(),this.stop())}get time(){return tn()}onTimerEnd(t){this.onEndCallback=t}start(t){this.stop(),nn(t),this.intervalId=ot(()=>this.onTickTimer(),1e3)}stop(){this.intervalId&&(Kt(this.intervalId),this.intervalId=null)}};const st=new Ir;st.onTimerEnd(()=>Cr.clickSubmit());class Lr{taskFields=null;onChangeTaskCallback=null;get targetSelector(){return".survey-meta-fields"}onChangeTask(t){this.onChangeTaskCallback=t}observe(){const t=document.querySelector(this.targetSelector);if(!t){q.error("Task fields not found");return}const n=Array.from(t.querySelectorAll(".labeled-attribute__attribute"));if(!n.length){q.error("Task fields attributes not found");return}const[r,o,s]=n,i=Pn(5*1e3,15*1e3),l=Dr(s.textContent.trim())+i,u={taskType:r.textContent,requestId:o.textContent,estimated:l};u.requestId!==this.taskFields?.requestId&&(q.info("Task fields changed",u),this.onChangeTaskCallback(u),me.isAutoSubmit||me.toggle(),this.taskFields&&(q.info("Task is submitted",this.taskFields),Ie.write({type:this.taskFields.taskType,estimated:this.taskFields.estimated})),this.taskFields=u)}}const it=new Lr;it.onChangeTask(e=>{st.start(e.estimated),Qt.start()});async function Pr(){const e=document.querySelector("#app-root");if(!e){q.error("App root not found");return}kt(e,()=>{Re.autoClose&&Re.closeValidationFailed()}),Un(it.targetSelector).then(()=>{ot(()=>it.observe(),7*1e3)}).finally(()=>q.info("Initialized task fields observer"))}const Nr=re("<button>M"),jr=()=>(()=>{const e=Nr();return e.$$click=()=>Re.toggleAutoClose(),ne(()=>e.classList.toggle("enabled",!!Re.autoClose)),e})();He(["click"]);const Rr=re('<button class="task-counter">'),Ur=()=>{const e=V(()=>{const t=Ee();return Ie.taskList.find(r=>r.date===t)?.total??"0"});return(()=>{const t=Rr();return t.$$click=()=>Ct.generateDailyPage(),oe(t,e),t})()};He(["click"]);const Fr=re("<div>Stopwatch: "),Yr=()=>{const e=V(()=>_t(Qt.time));return(()=>{const t=Fr();return t.firstChild,oe(t,e,null),t})()},zr=re("<div>Timer: "),Br=()=>{const e=V(()=>_t(st.time));return(()=>{const t=zr();return t.firstChild,oe(t,e,null),t})()},Vr="",Wr=()=>z(hr,{get children(){return z(fr,{get children(){return[z(Br,{}),z(Yr,{}),z(Ur,{}),z(qn,{}),z(jr,{})]}})}});Pr(),pr(),$n(()=>z(Wr,{}),document.body),GM_addStyle(":root{--try-font-family: monospace}.tryrating-widget{user-select:none;display:flex;color:#fff;padding-left:4px;background:#2e2c2f;font-size:1rem;font-weight:600;align-items:center;height:40px;justify-content:center;text-transform:uppercase;font-family:var(--try-font-family)}.tryrating-widget.draggable{cursor:pointer}.tryrating-widget.absolute{z-index:999999;position:absolute}.tryrating-widget.opacity-25{opacity:.25}.tryrating-widget>.task-counter{background:gray}.tryrating-widget>div{margin-left:6px;margin-right:6px}.tryrating-widget>button{text-transform:inherit;height:inherit;border:none;font-size:inherit;font-weight:inherit;color:#fff;padding-left:12px;padding-right:12px;background:#f44336}.tryrating-widget>button.enabled{background:#4caf50}.widget-drag-overlay{font-size:20px;font-weight:700;color:#3b99fc;width:100%;height:100%;position:absolute;text-align:center;align-self:center;text-transform:uppercase;background:rgba(0,0,0,.9)}.widget-drag-overlay>.text{font-family:var(--try-font-family);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%}")})();
